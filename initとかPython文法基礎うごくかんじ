# ============================================
# Python æŠ€è¡“ãƒ‡ãƒ¢ã‚³ãƒ¼ãƒ‰ - VSCodeå‹•ä½œç¢ºèªæ¸ˆã¿
# ============================================

from datetime import datetime
from abc import ABC, abstractmethod
import json


# ============================================
# 1. ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã®å®Ÿè£…
# ============================================

def log_execution(func):
    """é–¢æ•°ã®å®Ÿè¡Œã‚’ãƒ­ã‚°ã«è¨˜éŒ²ã™ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼"""
    def wrapper(*args, **kwargs):
        print(f"\n[LOG] {func.__name__} ã‚’å®Ÿè¡Œä¸­...")
        result = func(*args, **kwargs)
        print(f"[LOG] {func.__name__} ãŒå®Œäº†ã—ã¾ã—ãŸ")
        return result
    return wrapper


def validate_positive(func):
    """å¼•æ•°ãŒæ­£ã®æ•°ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼"""
    def wrapper(self, amount):
        if amount <= 0:
            raise ValueError(f"é‡‘é¡ã¯0ã‚ˆã‚Šå¤§ãã„å¿…è¦ãŒã‚ã‚Šã¾ã™: {amount}")
        return func(self, amount)
    return wrapper


# ============================================
# 2. æŠ½è±¡ã‚¯ãƒ©ã‚¹ã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
# ============================================

class Account(ABC):
    """éŠ€è¡Œå£åº§ã®æŠ½è±¡åŸºåº•ã‚¯ãƒ©ã‚¹"""
    
    def __init__(self, account_number, owner, balance=0):
        self._account_number = account_number
        self._owner = owner
        self._balance = balance
        self._transactions = []
    
    @property
    def account_number(self):
        return self._account_number
    
    @property
    def owner(self):
        return self._owner
    
    @property
    def balance(self):
        return self._balance
    
    @abstractmethod
    def calculate_interest(self):
        """å„å£åº§ã‚¿ã‚¤ãƒ—ã§å®Ÿè£…ãŒå¿…è¦ãªæŠ½è±¡ãƒ¡ã‚½ãƒƒãƒ‰"""
        pass
    
    @validate_positive
    @log_execution
    def deposit(self, amount):
        """å…¥é‡‘å‡¦ç†"""
        self._balance += amount
        self._add_transaction("å…¥é‡‘", amount)
        return self._balance
    
    @validate_positive
    @log_execution
    def withdraw(self, amount):
        """å‡ºé‡‘å‡¦ç†"""
        if amount > self._balance:
            raise ValueError("æ®‹é«˜ä¸è¶³ã§ã™")
        self._balance -= amount
        self._add_transaction("å‡ºé‡‘", -amount)
        return self._balance
    
    def _add_transaction(self, type_name, amount):
        """å–å¼•å±¥æ­´ã«è¿½åŠ """
        transaction = {
            "timestamp": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
            "type": type_name,
            "amount": amount,
            "balance": self._balance
        }
        self._transactions.append(transaction)
    
    def get_statement(self):
        """å–å¼•æ˜ç´°ã‚’è¡¨ç¤º"""
        print(f"\n{'='*50}")
        print(f"å£åº§ç•ªå·: {self._account_number}")
        print(f"åç¾©äºº: {self._owner}")
        print(f"ç¾åœ¨æ®‹é«˜: Â¥{self._balance:,}")
        print(f"{'='*50}")
        print("\nå–å¼•å±¥æ­´:")
        for t in self._transactions:
            sign = "+" if t['amount'] > 0 else ""
            print(f"  {t['timestamp']} | {t['type']:6s} | {sign}Â¥{t['amount']:>8,} | æ®‹é«˜: Â¥{t['balance']:>10,}")
        print(f"{'='*50}\n")


# ============================================
# 3. å…·è±¡ã‚¯ãƒ©ã‚¹ã®å®Ÿè£…
# ============================================

class SavingsAccount(Account):
    """æ™®é€šé é‡‘å£åº§"""
    
    INTEREST_RATE = 0.001  # ã‚¯ãƒ©ã‚¹å¤‰æ•°: 0.1%
    
    def __init__(self, account_number, owner, balance=0):
        super().__init__(account_number, owner, balance)
        self._account_type = "æ™®é€šé é‡‘"
    
    def calculate_interest(self):
        """åˆ©æ¯è¨ˆç®—"""
        interest = self._balance * self.INTEREST_RATE
        print(f"åˆ©æ¯: Â¥{interest:,.2f} (é‡‘åˆ©: {self.INTEREST_RATE*100}%)")
        return interest
    
    def add_interest(self):
        """åˆ©æ¯ã‚’å£åº§ã«è¿½åŠ """
        interest = self.calculate_interest()
        self._balance += interest
        self._add_transaction("åˆ©æ¯", interest)
        print(f"åˆ©æ¯ Â¥{interest:,.2f} ã‚’è¿½åŠ ã—ã¾ã—ãŸ")


class FixedDepositAccount(Account):
    """å®šæœŸé é‡‘å£åº§"""
    
    INTEREST_RATE = 0.02  # 2%
    
    def __init__(self, account_number, owner, balance, term_months):
        super().__init__(account_number, owner, balance)
        self._account_type = "å®šæœŸé é‡‘"
        self._term_months = term_months
        self._maturity_date = None
    
    def calculate_interest(self):
        """æº€æœŸæ™‚ã®åˆ©æ¯è¨ˆç®—"""
        interest = self._balance * self.INTEREST_RATE * (self._term_months / 12)
        print(f"æº€æœŸåˆ©æ¯: Â¥{interest:,.2f} (æœŸé–“: {self._term_months}ãƒ¶æœˆ, é‡‘åˆ©: {self.INTEREST_RATE*100}%)")
        return interest
    
    def withdraw(self, amount):
        """å®šæœŸé é‡‘ã¯å‡ºé‡‘åˆ¶é™ã‚ã‚Š"""
        print("è­¦å‘Š: å®šæœŸé é‡‘ã¯æº€æœŸå‰ã®å‡ºé‡‘ã«ãƒšãƒŠãƒ«ãƒ†ã‚£ãŒã‚ã‚Šã¾ã™")
        return super().withdraw(amount)


# ============================================
# 4. ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹
# ============================================

class Bank:
    """éŠ€è¡Œã‚·ã‚¹ãƒ†ãƒ  - ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³é¢¨"""
    
    def __init__(self, name):
        self.name = name
        self.accounts = {}
        self._next_account_number = 1001
    
    def create_account(self, account_type, owner, initial_deposit=0, **kwargs):
        """æ–°è¦å£åº§é–‹è¨­"""
        account_number = f"ACC{self._next_account_number}"
        self._next_account_number += 1
        
        if account_type == "savings":
            account = SavingsAccount(account_number, owner, initial_deposit)
        elif account_type == "fixed":
            term = kwargs.get('term_months', 12)
            account = FixedDepositAccount(account_number, owner, initial_deposit, term)
        else:
            raise ValueError(f"ä¸æ˜ãªå£åº§ã‚¿ã‚¤ãƒ—: {account_type}")
        
        self.accounts[account_number] = account
        print(f"\nå£åº§é–‹è¨­å®Œäº†: {account_number} ({owner}æ§˜)")
        return account
    
    def get_account(self, account_number):
        """å£åº§ã‚’å–å¾—"""
        return self.accounts.get(account_number)
    
    def export_data(self, filename="bank_data.json"):
        """ãƒ‡ãƒ¼ã‚¿ã‚’JSONå‡ºåŠ›"""
        data = {
            "bank_name": self.name,
            "accounts": []
        }
        for acc_num, acc in self.accounts.items():
            data["accounts"].append({
                "account_number": acc_num,
                "owner": acc.owner,
                "balance": acc.balance,
                "transactions": acc._transactions
            })
        
        with open(filename, 'w', encoding='utf-8') as f:
            json.dump(data, f, ensure_ascii=False, indent=2)
        print(f"\nãƒ‡ãƒ¼ã‚¿ã‚’ {filename} ã«ä¿å­˜ã—ã¾ã—ãŸ")


# ============================================
# 5. ãƒ¡ã‚¤ãƒ³å®Ÿè¡Œéƒ¨åˆ†
# ============================================

def main():
    """ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚°ãƒ©ãƒ """
    
    print("=" * 60)
    print("PythonéŠ€è¡Œã‚·ã‚¹ãƒ†ãƒ  ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³".center(60))
    print("=" * 60)
    
    # éŠ€è¡Œã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
    bank = Bank("Pythonã¿ãšã»éŠ€è¡Œ")
    
    # å£åº§é–‹è¨­
    print("\nã€å£åº§é–‹è¨­ã€‘")
    tanaka_savings = bank.create_account("savings", "ç”°ä¸­å¤ªéƒ", 100000)
    suzuki_fixed = bank.create_account("fixed", "éˆ´æœ¨èŠ±å­", 500000, term_months=24)
    
    # å–å¼•å®Ÿè¡Œ
    print("\nã€å–å¼•å®Ÿè¡Œã€‘")
    try:
        tanaka_savings.deposit(50000)
        tanaka_savings.withdraw(30000)
        tanaka_savings.add_interest()
        
        suzuki_fixed.deposit(100000)
        suzuki_fixed.calculate_interest()
        
    except ValueError as e:
        print(f"ã‚¨ãƒ©ãƒ¼: {e}")
    
    # æ˜ç´°è¡¨ç¤º
    print("\nã€å£åº§æ˜ç´°ã€‘")
    tanaka_savings.get_statement()
    suzuki_fixed.get_statement()
    
    # ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
    print("\nã€ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€‘")
    bank.export_data()
    
    # ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚¢ã‚¯ã‚»ã‚¹ã®ãƒ‡ãƒ¢
    print("\nã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚¢ã‚¯ã‚»ã‚¹ã€‘")
    print(f"ç”°ä¸­æ§˜ã®æ®‹é«˜: Â¥{tanaka_savings.balance:,}")
    print(f"éˆ´æœ¨æ§˜ã®å£åº§ç•ªå·: {suzuki_fixed.account_number}")
    
    print("\n" + "=" * 60)
    print("ãƒ‡ãƒ¢å®Œäº†ï¼".center(60))
    print("=" * 60)


# ============================================
# ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œ
# ============================================

if __name__ == "__main__":
    main()


# ============================================
# Pythonæ–°äººç ”ä¿® - ç·åˆæŠ€è¡“ãƒ‡ãƒ¢ã‚³ãƒ¼ãƒ‰
# ============================================

import os
import json
from datetime import datetime, timedelta
from typing import List, Dict, Optional
from dataclasses import dataclass
from enum import Enum


# ============================================
# 1. Enumï¼ˆåˆ—æŒ™å‹ï¼‰- å®šæ•°ç®¡ç†
# ============================================

class EmployeeStatus(Enum):
    """ç¤¾å“¡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹"""
    ACTIVE = "åœ¨è·ä¸­"
    ON_LEAVE = "ä¼‘è·ä¸­"
    RETIRED = "é€€è·æ¸ˆã¿"


class Department(Enum):
    """éƒ¨ç½²"""
    ENGINEERING = "ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°éƒ¨"
    SALES = "å–¶æ¥­éƒ¨"
    HR = "äººäº‹éƒ¨"
    MARKETING = "ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨"


# ============================================
# 2. dataclass - ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹
# ============================================

@dataclass
class Address:
    """ä½æ‰€ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹"""
    postal_code: str
    prefecture: str
    city: str
    street: str
    
    def full_address(self) -> str:
        return f"ã€’{self.postal_code} {self.prefecture}{self.city}{self.street}"


# ============================================
# 3. ä¾‹å¤–å‡¦ç† - ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–
# ============================================

class InvalidSalaryError(Exception):
    """çµ¦ä¸ãŒä¸æ­£ãªå ´åˆã®ä¾‹å¤–"""
    pass


class EmployeeNotFoundError(Exception):
    """ç¤¾å“¡ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã®ä¾‹å¤–"""
    pass


# ============================================
# 4. ã‚¯ãƒ©ã‚¹è¨­è¨ˆ - ç¤¾å“¡ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
# ============================================

class Employee:
    """ç¤¾å“¡ã‚¯ãƒ©ã‚¹"""
    
    # ã‚¯ãƒ©ã‚¹å¤‰æ•°
    _employee_count = 0
    MIN_SALARY = 200000
    MAX_SALARY = 10000000
    
    def __init__(self, name: str, department: Department, salary: int, address: Address):
        if salary < self.MIN_SALARY or salary > self.MAX_SALARY:
            raise InvalidSalaryError(f"çµ¦ä¸ã¯{self.MIN_SALARY:,}å††ã€œ{self.MAX_SALARY:,}å††ã®ç¯„å›²ã§è¨­å®šã—ã¦ãã ã•ã„")
        
        Employee._employee_count += 1
        self._employee_id = f"EMP{Employee._employee_count:04d}"
        self._name = name
        self._department = department
        self._salary = salary
        self._address = address
        self._status = EmployeeStatus.ACTIVE
        self._hire_date = datetime.now()
        self._performance_history: List[Dict] = []
    
    # ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆã‚²ãƒƒã‚¿ãƒ¼ï¼‰
    @property
    def employee_id(self) -> str:
        return self._employee_id
    
    @property
    def name(self) -> str:
        return self._name
    
    @property
    def department(self) -> Department:
        return self._department
    
    @property
    def salary(self) -> int:
        return self._salary
    
    @property
    def status(self) -> EmployeeStatus:
        return self._status
    
    # ã‚»ãƒƒã‚¿ãƒ¼ï¼ˆæ¤œè¨¼ä»˜ãï¼‰
    @salary.setter
    def salary(self, value: int):
        if value < self.MIN_SALARY or value > self.MAX_SALARY:
            raise InvalidSalaryError(f"çµ¦ä¸ã¯{self.MIN_SALARY:,}å††ã€œ{self.MAX_SALARY:,}å††ã®ç¯„å›²ã§è¨­å®šã—ã¦ãã ã•ã„")
        self._salary = value
    
    @status.setter
    def status(self, value: EmployeeStatus):
        self._status = value
    
    # ãƒ¡ã‚½ãƒƒãƒ‰
    def add_performance_review(self, rating: int, comment: str):
        """æ¥­ç¸¾è©•ä¾¡ã‚’è¿½åŠ """
        if not 1 <= rating <= 5:
            raise ValueError("è©•ä¾¡ã¯1ã€œ5ã®ç¯„å›²ã§å…¥åŠ›ã—ã¦ãã ã•ã„")
        
        review = {
            "date": datetime.now().strftime("%Y-%m-%d"),
            "rating": rating,
            "comment": comment
        }
        self._performance_history.append(review)
        print(f"âœ… {self._name}ã•ã‚“ã®è©•ä¾¡ã‚’è¿½åŠ ã—ã¾ã—ãŸ (è©•ä¾¡: {rating}/5)")
    
    def get_average_rating(self) -> Optional[float]:
        """å¹³å‡è©•ä¾¡ã‚’å–å¾—"""
        if not self._performance_history:
            return None
        ratings = [review["rating"] for review in self._performance_history]
        return sum(ratings) / len(ratings)
    
    def give_raise(self, percentage: float):
        """æ˜‡çµ¦å‡¦ç†"""
        if percentage <= 0 or percentage > 50:
            raise ValueError("æ˜‡çµ¦ç‡ã¯0ã€œ50%ã®ç¯„å›²ã§è¨­å®šã—ã¦ãã ã•ã„")
        
        old_salary = self._salary
        increase = int(self._salary * (percentage / 100))
        self._salary += increase
        print(f"ğŸ’° {self._name}ã•ã‚“ã®çµ¦ä¸ã‚’{percentage}%æ˜‡çµ¦ã—ã¾ã—ãŸ")
        print(f"   {old_salary:,}å†† â†’ {self._salary:,}å†† (+{increase:,}å††)")
    
    def get_years_of_service(self) -> float:
        """å‹¤ç¶šå¹´æ•°ã‚’å–å¾—"""
        delta = datetime.now() - self._hire_date
        return round(delta.days / 365.25, 1)
    
    def __str__(self) -> str:
        """æ–‡å­—åˆ—è¡¨ç¾"""
        return f"{self._employee_id} - {self._name} ({self._department.value})"
    
    def __repr__(self) -> str:
        """é–‹ç™ºè€…å‘ã‘è¡¨ç¾"""
        return f"Employee(id={self._employee_id}, name={self._name})"
    
    def to_dict(self) -> Dict:
        """è¾æ›¸å‹ã«å¤‰æ›ï¼ˆJSONå‡ºåŠ›ç”¨ï¼‰"""
        return {
            "employee_id": self._employee_id,
            "name": self._name,
            "department": self._department.value,
            "salary": self._salary,
            "status": self._status.value,
            "address": self._address.full_address(),
            "hire_date": self._hire_date.strftime("%Y-%m-%d"),
            "years_of_service": self.get_years_of_service(),
            "average_rating": self.get_average_rating(),
            "performance_history": self._performance_history
        }


# ============================================
# 5. ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ - withæ–‡
# ============================================

class EmployeeDatabase:
    """ç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ - withæ–‡ã§ä½¿ç”¨"""
    
    def __init__(self, filename: str):
        self.filename = filename
        self.employees: Dict[str, Employee] = {}
    
    def __enter__(self):
        """withæ–‡ã®é–‹å§‹æ™‚"""
        print(f"ğŸ“‚ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ '{self.filename}' ã‚’é–‹ã„ã¦ã„ã¾ã™...")
        return self
    
    def __exit__(self, exc_type, exc_val, exc_tb):
        """withæ–‡ã®çµ‚äº†æ™‚ï¼ˆè‡ªå‹•ä¿å­˜ï¼‰"""
        if exc_type is None:
            self.save_to_file()
            print(f"âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä¿å­˜ã—ã¦é–‰ã˜ã¾ã—ãŸ")
        else:
            print(f"âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {exc_val}")
        return False
    
    def add_employee(self, employee: Employee):
        """ç¤¾å“¡ã‚’è¿½åŠ """
        self.employees[employee.employee_id] = employee
        print(f"â• {employee.name}ã•ã‚“ã‚’ç™»éŒ²ã—ã¾ã—ãŸ (ID: {employee.employee_id})")
    
    def get_employee(self, employee_id: str) -> Employee:
        """ç¤¾å“¡ã‚’å–å¾—"""
        if employee_id not in self.employees:
            raise EmployeeNotFoundError(f"ç¤¾å“¡ID {employee_id} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
        return self.employees[employee_id]
    
    def search_by_department(self, department: Department) -> List[Employee]:
        """éƒ¨ç½²ã§æ¤œç´¢"""
        return [emp for emp in self.employees.values() if emp.department == department]
    
    def get_salary_statistics(self) -> Dict:
        """çµ¦ä¸çµ±è¨ˆã‚’å–å¾—"""
        salaries = [emp.salary for emp in self.employees.values()]
        if not salaries:
            return {}
        
        return {
            "å¹³å‡çµ¦ä¸": f"Â¥{sum(salaries) // len(salaries):,}",
            "æœ€é«˜çµ¦ä¸": f"Â¥{max(salaries):,}",
            "æœ€ä½çµ¦ä¸": f"Â¥{min(salaries):,}",
            "ç¤¾å“¡æ•°": len(salaries)
        }
    
    def save_to_file(self):
        """ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜"""
        data = {
            "saved_at": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
            "total_employees": len(self.employees),
            "employees": [emp.to_dict() for emp in self.employees.values()]
        }
        
        with open(self.filename, 'w', encoding='utf-8') as f:
            json.dump(data, f, ensure_ascii=False, indent=2)


# ============================================
# 6. ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ - é–¢æ•°ã®æ‹¡å¼µ
# ============================================

def require_active_employee(func):
    """ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªç¤¾å“¡ã®ã¿æ“ä½œå¯èƒ½ã«ã™ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼"""
    def wrapper(self, employee: Employee, *args, **kwargs):
        if employee.status != EmployeeStatus.ACTIVE:
            print(f"âš ï¸  {employee.name}ã•ã‚“ã¯{employee.status.value}ã®ãŸã‚ã€ã“ã®æ“ä½œã¯ã§ãã¾ã›ã‚“")
            return None
        return func(self, employee, *args, **kwargs)
    return wrapper


# ============================================
# 7. å¿œç”¨ã‚¯ãƒ©ã‚¹ - ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
# ============================================

class HRManager:
    """äººäº‹ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚¯ãƒ©ã‚¹"""
    
    def __init__(self, name: str):
        self.name = name
    
    @require_active_employee
    def conduct_review(self, employee: Employee, rating: int, comment: str):
        """æ¥­ç¸¾è©•ä¾¡ã‚’å®Ÿæ–½"""
        employee.add_performance_review(rating, comment)
        
        # è©•ä¾¡ã«å¿œã˜ãŸå‡¦ç†
        if rating >= 4:
            print(f"ğŸŒŸ å„ªç§€ãªè©•ä¾¡ã§ã™ï¼æ˜‡çµ¦ã‚’æ¤œè¨ã—ã¾ã™")
            employee.give_raise(5.0)
    
    @require_active_employee
    def promote(self, employee: Employee, new_salary: int):
        """æ˜‡é€²å‡¦ç†"""
        old_salary = employee.salary
        employee.salary = new_salary
        print(f"ğŸ‰ {employee.name}ã•ã‚“ã‚’æ˜‡é€²ã•ã›ã¾ã—ãŸï¼")
        print(f"   çµ¦ä¸: Â¥{old_salary:,} â†’ Â¥{new_salary:,}")


# ============================================
# 8. ãƒªã‚¹ãƒˆå†…åŒ…è¡¨è¨˜ãƒ»ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼
# ============================================

def generate_report(employees: List[Employee]) -> str:
    """ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ"""
    lines = ["=" * 70, "ç¤¾å“¡ä¸€è¦§ãƒ¬ãƒãƒ¼ãƒˆ".center(70), "=" * 70]
    
    # ãƒªã‚¹ãƒˆå†…åŒ…è¡¨è¨˜
    active_employees = [emp for emp in employees if emp.status == EmployeeStatus.ACTIVE]
    
    for emp in active_employees:
        avg_rating = emp.get_average_rating()
        rating_str = f"{avg_rating:.1f}/5" if avg_rating else "æœªè©•ä¾¡"
        
        lines.append(f"{emp.employee_id} | {emp.name:10s} | {emp.department.value:20s} | Â¥{emp.salary:>10,} | è©•ä¾¡: {rating_str}")
    
    lines.append("=" * 70)
    return "\n".join(lines)


# ============================================
# 9. ãƒ¡ã‚¤ãƒ³å®Ÿè¡Œéƒ¨åˆ†
# ============================================

def main():
    """ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚°ãƒ©ãƒ """
    
    print("=" * 70)
    print("Pythonæ–°äººç ”ä¿® - ç¤¾å“¡ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ãƒ‡ãƒ¢".center(70))
    print("=" * 70)
    print()
    
    try:
        # ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ä½¿ç”¨ï¼ˆwithæ–‡ï¼‰
        with EmployeeDatabase("employees.json") as db:
            
            # ç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ä½œæˆ
            print("\nã€1. ç¤¾å“¡ç™»éŒ²ã€‘")
            employees = [
                Employee("å±±ç”°å¤ªéƒ", Department.ENGINEERING, 500000, 
                        Address("100-0001", "æ±äº¬éƒ½", "åƒä»£ç”°åŒº", "åƒä»£ç”°1-1")),
                Employee("ä½è—¤èŠ±å­", Department.SALES, 450000,
                        Address("150-0001", "æ±äº¬éƒ½", "æ¸‹è°·åŒº", "ç¥å®®å‰1-1")),
                Employee("éˆ´æœ¨ä¸€éƒ", Department.HR, 480000,
                        Address("160-0001", "æ±äº¬éƒ½", "æ–°å®¿åŒº", "è¥¿æ–°å®¿1-1")),
            ]
            
            for emp in employees:
                db.add_employee(emp)
            
            print("\nã€2. æ¥­ç¸¾è©•ä¾¡ã€‘")
            hr_manager = HRManager("ç”°ä¸­éƒ¨é•·")
            hr_manager.conduct_review(employees[0], 5, "å„ªç§€ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹")
            hr_manager.conduct_review(employees[0], 4, "è‰¯å¥½ãªæˆæœ")
            hr_manager.conduct_review(employees[1], 3, "æ¨™æº–çš„ãªæˆæœ")
            
            print("\nã€3. éƒ¨ç½²åˆ¥æ¤œç´¢ã€‘")
            eng_employees = db.search_by_department(Department.ENGINEERING)
            print(f"ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°éƒ¨: {len(eng_employees)}å")
            for emp in eng_employees:
                print(f"  - {emp}")
            
            print("\nã€4. çµ¦ä¸çµ±è¨ˆã€‘")
            stats = db.get_salary_statistics()
            for key, value in stats.items():
                print(f"  {key}: {value}")
            
            print("\nã€5. ç¤¾å“¡ãƒ¬ãƒãƒ¼ãƒˆã€‘")
            report = generate_report(list(db.employees.values()))
            print(report)
            
            print("\nã€6. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ãƒ‡ãƒ¢ã€‘")
            try:
                # ä¸æ­£ãªçµ¦ä¸ã§ç¤¾å“¡ä½œæˆã‚’è©¦ã¿ã‚‹
                invalid_emp = Employee("ãƒ†ã‚¹ãƒˆ", Department.SALES, 100000,
                                     Address("100-0001", "æ±äº¬éƒ½", "åƒä»£ç”°åŒº", "åƒä»£ç”°1-1"))
            except InvalidSalaryError as e:
                print(f"âŒ ã‚¨ãƒ©ãƒ¼: {e}")
            
            print("\nã€7. Type Hintingã®æ´»ç”¨ã€‘")
            def calculate_bonus(salary: int, rating: Optional[float]) -> int:
                """ãƒœãƒ¼ãƒŠã‚¹è¨ˆç®—ï¼ˆå‹ãƒ’ãƒ³ãƒˆä»˜ãï¼‰"""
                if rating is None or rating < 3:
                    return 0
                return int(salary * 0.5 * (rating / 5))
            
            for emp in employees:
                bonus = calculate_bonus(emp.salary, emp.get_average_rating())
                if bonus > 0:
                    print(f"  {emp.name}ã•ã‚“ã®ãƒœãƒ¼ãƒŠã‚¹: Â¥{bonus:,}")
            
    except Exception as e:
        print(f"\nâŒ äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼: {e}")
        import traceback
        traceback.print_exc()
    
    print("\n" + "=" * 70)
    print("ãƒ‡ãƒ¢å®Œäº†ï¼employees.json ã‚’ç¢ºèªã—ã¦ãã ã•ã„".center(70))
    print("=" * 70)


# ============================================
# ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œ
# ============================================

if __name__ == "__main__":
    main()


ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
# ============================================
# __init__ ã¨ã¯ä½•ã‹ï¼Ÿå®Œå…¨ç†è§£ã‚³ãƒ¼ãƒ‰
# ============================================

print("=" * 60)
print("__init__ ã®ä»•çµ„ã¿ã‚’ç†è§£ã—ã‚ˆã†ï¼")
print("=" * 60)

# ============================================
# 1. æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªä¾‹
# ============================================

print("\nã€1. åŸºæœ¬: __init__ãŒãªã„å ´åˆã€‘")

class Dog1:
    pass  # ä½•ã‚‚ãªã„

# ä½¿ã£ã¦ã¿ã‚‹
dog = Dog1()
print(f"çŠ¬ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ: {dog}")
print("ã§ã‚‚ã€åå‰ã‚‚å¹´é½¢ã‚‚è¨­å®šã§ããªã„...")


print("\nã€2. __init__ã‚’è¿½åŠ : ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆæ™‚ã«å€¤ã‚’è¨­å®šã€‘")

class Dog2:
    # __init__ = ã€ŒåˆæœŸåŒ–ãƒ¡ã‚½ãƒƒãƒ‰ã€
    # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒä½œã‚‰ã‚Œã‚‹æ™‚ã«ã€Œè‡ªå‹•ã§ã€å®Ÿè¡Œã•ã‚Œã‚‹ç‰¹åˆ¥ãªé–¢æ•°
    def __init__(self, name, age):
        print(f"  â†’ __init__ãŒå‘¼ã°ã‚Œã¾ã—ãŸï¼")
        self.name = name  # è‡ªåˆ†è‡ªèº«(self)ã«åå‰ã‚’ä¿å­˜
        self.age = age    # è‡ªåˆ†è‡ªèº«(self)ã«å¹´é½¢ã‚’ä¿å­˜
        print(f"  â†’ {name}ã¨ã„ã†çŠ¬ã‚’ä½œæˆä¸­...")

# ä½¿ã£ã¦ã¿ã‚‹
pochi = Dog2("ãƒãƒ", 3)  # â† ã“ã®æ™‚ã«__init__ãŒè‡ªå‹•å®Ÿè¡Œã•ã‚Œã‚‹ï¼
print(f"åå‰: {pochi.name}")
print(f"å¹´é½¢: {pochi.age}æ­³")

tama = Dog2("ã‚¿ãƒ", 5)
print(f"åå‰: {tama.name}")
print(f"å¹´é½¢: {tama.age}æ­³")


# ============================================
# 3. selfã£ã¦ä½•ï¼Ÿ
# ============================================

print("\nã€3. selfã®æ­£ä½“ã€‘")

class Cat:
    def __init__(self, name):
        # self = ã€Œä»Šä½œã£ã¦ã„ã‚‹ã€ã“ã®çŒ«è‡ªèº«ã€ã¨ã„ã†æ„å‘³
        print(f"  self = {self}")  # selfã®æ­£ä½“ã‚’è¡¨ç¤º
        self.name = name

mike = Cat("ãƒŸã‚±")
print(f"mike = {mike}")
print("â†‘ selfã¨mikeã¯åŒã˜ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡ã—ã¦ã„ã‚‹ï¼")

shiro = Cat("ã‚·ãƒ­")
print(f"shiro = {shiro}")
print("â†‘ ãã‚Œãã‚Œåˆ¥ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ")


# ============================================
# 4. __init__ã§ã§ãã‚‹ã“ã¨
# ============================================

print("\nã€4. __init__ã§ã„ã‚ã„ã‚åˆæœŸåŒ–ã€‘")

class Car:
    def __init__(self, maker, model, year):
        # åŸºæœ¬çš„ãªæƒ…å ±ã‚’ä¿å­˜
        self.maker = maker
        self.model = model
        self.year = year
        
        # åˆæœŸå€¤ã‚’è‡ªå‹•è¨­å®š
        self.mileage = 0  # èµ°è¡Œè·é›¢ã¯æœ€åˆ0km
        self.is_running = False  # ã‚¨ãƒ³ã‚¸ãƒ³åœæ­¢çŠ¶æ…‹
        
        # è¨ˆç®—ã—ãŸå€¤ã‚’ä¿å­˜
        self.age = 2025 - year  # è»Šé½¢ã‚’è¨ˆç®—
        
        print(f"âœ… {maker} {model}ã‚’ç™»éŒ²ã—ã¾ã—ãŸï¼ˆ{year}å¹´å¼ã€{self.age}å¹´è½ã¡ï¼‰")

my_car = Car("ãƒˆãƒ¨ã‚¿", "ãƒ—ãƒªã‚¦ã‚¹", 2020)
print(f"èµ°è¡Œè·é›¢: {my_car.mileage}km")
print(f"ã‚¨ãƒ³ã‚¸ãƒ³: {'ON' if my_car.is_running else 'OFF'}")


# ============================================
# 5. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®š
# ============================================

print("\nã€5. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆçœç•¥å¯èƒ½ãªå¼•æ•°ï¼‰ã€‘")

class BankAccount:
    def __init__(self, owner, balance=0):  # balanceçœç•¥å¯èƒ½
        self.owner = owner
        self.balance = balance
        print(f"ğŸ’° {owner}ã•ã‚“ã®å£åº§ã‚’ä½œæˆï¼ˆæ®‹é«˜: Â¥{balance:,}ï¼‰")

# æ®‹é«˜ã‚’æŒ‡å®š
account1 = BankAccount("ç”°ä¸­å¤ªéƒ", 100000)

# æ®‹é«˜ã‚’çœç•¥ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®0ã«ãªã‚‹ï¼‰
account2 = BankAccount("ä½è—¤èŠ±å­")


# ============================================
# 6. __init__ã§æ¤œè¨¼ï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
# ============================================

print("\nã€6. __init__ã§ä¸æ­£ãªå€¤ã‚’ãƒã‚§ãƒƒã‚¯ã€‘")

class Person:
    def __init__(self, name, age):
        # å¹´é½¢ãƒã‚§ãƒƒã‚¯
        if age < 0:
            raise ValueError("å¹´é½¢ã¯0ä»¥ä¸Šã«ã—ã¦ãã ã•ã„ï¼")
        if age > 150:
            raise ValueError("å¹´é½¢ãŒä¸è‡ªç„¶ã§ã™ï¼")
        
        self.name = name
        self.age = age
        print(f"ğŸ‘¤ {name}ã•ã‚“ï¼ˆ{age}æ­³ï¼‰ã‚’ç™»éŒ²")

# æ­£å¸¸ãªã‚±ãƒ¼ã‚¹
person1 = Person("å±±ç”°å¤ªéƒ", 25)

# ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹
try:
    person2 = Person("ä½è—¤æ¬¡éƒ", -5)  # â† ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿï¼
except ValueError as e:
    print(f"âŒ ã‚¨ãƒ©ãƒ¼: {e}")


# ============================================
# 7. __init__å†…ã§ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã¶
# ============================================

print("\nã€7. __init__ã‹ã‚‰åˆ¥ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã€‘")

class Robot:
    def __init__(self, name):
        self.name = name
        self.battery = 100
        
        # åˆæœŸåŒ–æ™‚ã«æŒ¨æ‹¶ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã¶
        self.greet()
        self.check_battery()
    
    def greet(self):
        print(f"ğŸ¤– ã“ã‚“ã«ã¡ã¯ï¼{self.name}ã§ã™ï¼")
    
    def check_battery(self):
        print(f"ğŸ”‹ ãƒãƒƒãƒ†ãƒªãƒ¼æ®‹é‡: {self.battery}%")

robot = Robot("ã‚¢ãƒˆãƒ ")


# ============================================
# 8. å®Ÿè·µä¾‹ï¼šRPGã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
# ============================================

print("\nã€8. å®Ÿè·µä¾‹: RPGã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä½œæˆã€‘")

class Character:
    def __init__(self, name, job, level=1):
        # ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æƒ…å ±
        self.name = name
        self.job = job
        self.level = level
        
        # ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ã¦ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è‡ªå‹•è¨ˆç®—
        self.hp = 100 + (level * 10)
        self.mp = 50 + (level * 5)
        self.attack = 10 + (level * 2)
        self.defense = 5 + level
        
        # è£…å‚™ã¯åˆæœŸçŠ¶æ…‹ã§ç©º
        self.weapon = None
        self.armor = None
        
        print(f"âš”ï¸  ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä½œæˆå®Œäº†ï¼")
        self.show_status()
    
    def show_status(self):
        print(f"   åå‰: {self.name}")
        print(f"   è·æ¥­: {self.job}")
        print(f"   ãƒ¬ãƒ™ãƒ«: {self.level}")
        print(f"   HP: {self.hp} / MP: {self.mp}")
        print(f"   æ”»æ’ƒåŠ›: {self.attack} / é˜²å¾¡åŠ›: {self.defense}")

# ãƒ¬ãƒ™ãƒ«1ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
hero1 = Character("å‹‡è€…ã‚¢ãƒ¬ãƒƒã‚¯ã‚¹", "æˆ¦å£«")

print()

# ãƒ¬ãƒ™ãƒ«10ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
hero2 = Character("é­”æ³•ä½¿ã„ãƒ™ãƒ©", "é­”æ³•ä½¿ã„", level=10)


# ============================================
# 9. ã¾ã¨ã‚
# ============================================

print("\n" + "=" * 60)
print("ã€ã¾ã¨ã‚ã€‘")
print("=" * 60)
print("""
__init__ ã¨ã¯ï¼š
  âœ“ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚‹æ™‚ã«ã€Œè‡ªå‹•ã§å®Ÿè¡Œã•ã‚Œã‚‹ã€ç‰¹åˆ¥ãªãƒ¡ã‚½ãƒƒãƒ‰
  âœ“ ã€Œã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€ã‚„ã€ŒåˆæœŸåŒ–ãƒ¡ã‚½ãƒƒãƒ‰ã€ã¨å‘¼ã°ã‚Œã‚‹
  âœ“ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸçŠ¶æ…‹ã‚’è¨­å®šã™ã‚‹ãŸã‚ã«ä½¿ã†

ä½¿ã„æ–¹ï¼š
  class ã‚¯ãƒ©ã‚¹å:
      def __init__(self, å¼•æ•°1, å¼•æ•°2, ...):
          self.å±æ€§1 = å¼•æ•°1
          self.å±æ€§2 = å¼•æ•°2
          # åˆæœŸåŒ–å‡¦ç†

selfã¨ã¯ï¼š
  âœ“ ã€Œä»Šä½œã£ã¦ã„ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆè‡ªèº«ã€ã‚’æŒ‡ã™
  âœ“ å¿…ãšç¬¬1å¼•æ•°ã«æ›¸ãï¼ˆåå‰ã¯æ…£ä¾‹ã§selfï¼‰
  âœ“ self.xxxx ã§å±æ€§ã‚’ä¿å­˜

ãƒã‚¤ãƒ³ãƒˆï¼š
  âœ“ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã§å¼•æ•°ã‚’çœç•¥å¯èƒ½ã«ã§ãã‚‹
  âœ“ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ¤œè¨¼ï¼‰ã‚’å…¥ã‚Œã‚‰ã‚Œã‚‹
  âœ“ è¨ˆç®—ã—ãŸå€¤ã‚’è‡ªå‹•è¨­å®šã§ãã‚‹
  âœ“ ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã›ã‚‹
""")

print("=" * 60)
print("ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€__init__ã®å‹•ãã‚’ç¢ºèªã—ã‚ˆã†ï¼")
print("=" * 60)

ãƒ¼ãƒ¼ãƒ¼
