Python Selenium ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°å®Œå…¨ã‚¬ã‚¤ãƒ‰ ğŸš€
æ–°äººã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®æ–¹å‘ã‘ã«ã€XPathã¨CSSã‚»ãƒ¬ã‚¯ã‚¿ã‚’ä½¿ã£ãŸã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’ã€æ¶ç©ºã®HTMLæ§‹é€ ã§ä¸å¯§ã«è§£èª¬ã—ã¾ã™ã€‚
ğŸ“‹ æ¶ç©ºã®ECã‚µã‚¤ãƒˆæ§‹é€ ä¾‹
ã¾ãšã€ã‚ˆãã‚ã‚‹ECã‚µã‚¤ãƒˆã®HTMLæ§‹é€ ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
<html>
  <body>
    <div id="container">
      <header class="site-header">
        <nav class="navigation">...</nav>
      </header>
      
      <main class="content">
        <div class="product-list">
          <article class="product-card" data-id="001">
            <div class="product-image">
              <img src="product1.jpg" alt="å•†å“A">
            </div>
            <div class="product-info">
              <h2 class="product-title">ãƒ¯ã‚¤ãƒ¤ãƒ¬ã‚¹ã‚¤ãƒ¤ãƒ›ãƒ³</h2>
              <span class="price" data-price="5980">Â¥5,980</span>
              <div class="rating">
                <span class="stars">â˜…â˜…â˜…â˜…â˜†</span>
                <span class="review-count">(128ä»¶)</span>
              </div>
              <button class="btn-cart">ã‚«ãƒ¼ãƒˆã«å…¥ã‚Œã‚‹</button>
            </div>
          </article>
          
          <article class="product-card" data-id="002">
            <div class="product-image">
              <img src="product2.jpg" alt="å•†å“B">
            </div>
            <div class="product-info">
              <h2 class="product-title">ã‚¹ãƒãƒ¼ãƒˆã‚¦ã‚©ãƒƒãƒ</h2>
              <span class="price" data-price="12800">Â¥12,800</span>
              <div class="rating">
                <span class="stars">â˜…â˜…â˜…â˜…â˜…</span>
                <span class="review-count">(256ä»¶)</span>
              </div>
              <button class="btn-cart">ã‚«ãƒ¼ãƒˆã«å…¥ã‚Œã‚‹</button>
            </div>
          </article>
        </div>
      </main>
    </div>
  </body>
</html>


ğŸ¯ 1. XPath vs CSSã‚»ãƒ¬ã‚¯ã‚¿ æ¯”è¼ƒè¡¨
ç‰¹å¾´
XPath
CSSã‚»ãƒ¬ã‚¯ã‚¿
é€Ÿåº¦
ã‚„ã‚„é…ã„
é«˜é€Ÿ
æŸ”è»Ÿæ€§
éå¸¸ã«é«˜ã„(è¦ªè¦ç´ å–å¾—å¯èƒ½)
ä¸­ç¨‹åº¦
ãƒ†ã‚­ã‚¹ãƒˆæ¤œç´¢
â— å¯èƒ½
Ã— ä¸å¯
å±æ€§æ¤œç´¢
â— å¼·åŠ›
â—‹ åŸºæœ¬çš„ãªã‚‚ã®
å¯èª­æ€§
ã‚„ã‚„è¤‡é›‘
ã‚·ãƒ³ãƒ—ãƒ«


ğŸ” 2. CSSã‚»ãƒ¬ã‚¯ã‚¿ - åŸºæœ¬ã‹ã‚‰å¿œç”¨ã¾ã§
åŸºæœ¬ã‚»ãƒ¬ã‚¯ã‚¿
from selenium import webdriver
from selenium.webdriver.common.by import By

driver = webdriver.Chrome()

# â‘  ã‚¯ãƒ©ã‚¹ã§å–å¾—
products = driver.find_elements(By.CSS_SELECTOR, ".product-card")

# â‘¡ IDã§å–å¾—
container = driver.find_element(By.CSS_SELECTOR, "#container")

# â‘¢ ã‚¿ã‚°åã§å–å¾—
all_buttons = driver.find_elements(By.CSS_SELECTOR, "button")

# â‘£ è¤‡æ•°ã‚¯ãƒ©ã‚¹(ANDæ¡ä»¶)
# class="product-card featured"ã®è¦ç´ 
featured_products = driver.find_elements(By.CSS_SELECTOR, ".product-card.featured")

éšå±¤æ§‹é€ ã®ã‚»ãƒ¬ã‚¯ã‚¿
# â‘¤ å­å­«ã‚»ãƒ¬ã‚¯ã‚¿(ã‚¹ãƒšãƒ¼ã‚¹) - å…¨ã¦ã®å­å­«è¦ç´ 
# .product-list ã®ä¸­ã®å…¨ã¦ã® .price
prices = driver.find_elements(By.CSS_SELECTOR, ".product-list .price")

# â‘¥ ç›´æ¥ã®å­ã‚»ãƒ¬ã‚¯ã‚¿(>) - ç›´ä¸‹ã®å­è¦ç´ ã®ã¿
# .product-card ã®ç›´ä¸‹ã® .product-info
info_divs = driver.find_elements(By.CSS_SELECTOR, ".product-card > .product-info")

# â‘¦ è¤‡æ•°éšå±¤ã®çµ„ã¿åˆã‚ã›
# main > .content ã®ä¸­ã® article.product-card å†…ã® h2
titles = driver.find_elements(By.CSS_SELECTOR, "main > .content article.product-card h2")

å±æ€§ã‚»ãƒ¬ã‚¯ã‚¿(è¶…ä¾¿åˆ©!)
# â‘§ å±æ€§ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
# data-idå±æ€§ã‚’æŒã¤è¦ç´ 
products_with_id = driver.find_elements(By.CSS_SELECTOR, "[data-id]")

# â‘¨ å±æ€§ã®å€¤ãŒå®Œå…¨ä¸€è‡´
# data-id="001"ã®è¦ç´ 
product_001 = driver.find_element(By.CSS_SELECTOR, "[data-id='001']")

# â‘© å±æ€§ã®å€¤ãŒéƒ¨åˆ†ä¸€è‡´(å«ã‚€)
# altå±æ€§ã«"å•†å“"ã‚’å«ã‚€ç”»åƒ
product_images = driver.find_elements(By.CSS_SELECTOR, "img[alt*='å•†å“']")

# â‘ª å±æ€§ã®å€¤ãŒå‰æ–¹ä¸€è‡´
# classãŒ"product-"ã§å§‹ã¾ã‚‹è¦ç´ 
product_elements = driver.find_elements(By.CSS_SELECTOR, "[class^='product-']")

# â‘« å±æ€§ã®å€¤ãŒå¾Œæ–¹ä¸€è‡´
# classãŒ"-card"ã§çµ‚ã‚ã‚‹è¦ç´ 
cards = driver.find_elements(By.CSS_SELECTOR, "[class$='-card']")

æ“¬ä¼¼ã‚¯ãƒ©ã‚¹(ä½ç½®æŒ‡å®š)
# â‘¬ æœ€åˆã®è¦ç´ 
first_product = driver.find_element(By.CSS_SELECTOR, ".product-card:first-child")

# â‘­ æœ€å¾Œã®è¦ç´ 
last_product = driver.find_element(By.CSS_SELECTOR, ".product-card:last-child")

# â‘® nç•ªç›®ã®è¦ç´ (1ã‹ã‚‰å§‹ã¾ã‚‹)
second_product = driver.find_element(By.CSS_SELECTOR, ".product-card:nth-child(2)")

# â‘¯ å¶æ•°ç•ªç›®ã®è¦ç´ 
even_products = driver.find_elements(By.CSS_SELECTOR, ".product-card:nth-child(even)")

# â‘° å¥‡æ•°ç•ªç›®ã®è¦ç´ 
odd_products = driver.find_elements(By.CSS_SELECTOR, ".product-card:nth-child(odd)")


ğŸ›¤ï¸ 3. XPath - ãƒ‘ãƒ¯ãƒ•ãƒ«ãªæ¤œç´¢
åŸºæœ¬æ§‹æ–‡
# â‘  çµ¶å¯¾ãƒ‘ã‚¹(éæ¨å¥¨ - å£Šã‚Œã‚„ã™ã„)
title = driver.find_element(By.XPATH, "/html/body/div/main/div/article[1]/div[2]/h2")

# â‘¡ ç›¸å¯¾ãƒ‘ã‚¹(æ¨å¥¨)
# ã©ã“ã‹ã‚‰ã§ã‚‚.product-titleã‚¯ãƒ©ã‚¹ã‚’æ¢ã™
titles = driver.find_elements(By.XPATH, "//h2[@class='product-title']")

# â‘¢ ã‚¯ãƒ©ã‚¹åã§æ¤œç´¢
products = driver.find_elements(By.XPATH, "//article[@class='product-card']")

# â‘£ IDã§æ¤œç´¢
container = driver.find_element(By.XPATH, "//*[@id='container']")

ãƒ†ã‚­ã‚¹ãƒˆã§æ¤œç´¢(XPathã®å¼·ã¿!)
# â‘¤ ãƒ†ã‚­ã‚¹ãƒˆãŒå®Œå…¨ä¸€è‡´
earphone = driver.find_element(By.XPATH, "//h2[text()='ãƒ¯ã‚¤ãƒ¤ãƒ¬ã‚¹ã‚¤ãƒ¤ãƒ›ãƒ³']")

# â‘¥ ãƒ†ã‚­ã‚¹ãƒˆãŒéƒ¨åˆ†ä¸€è‡´(contains)
# "ã‚¤ãƒ¤ãƒ›ãƒ³"ã‚’å«ã‚€h2è¦ç´ 
products = driver.find_elements(By.XPATH, "//h2[contains(text(), 'ã‚¤ãƒ¤ãƒ›ãƒ³')]")

# â‘¦ è¤‡æ•°æ¡ä»¶(and)
# class='price' ã‹ã¤ ãƒ†ã‚­ã‚¹ãƒˆã«"980"ã‚’å«ã‚€
prices = driver.find_elements(By.XPATH, "//span[@class='price' and contains(text(), '980')]")

éšå±¤æ§‹é€ ã®ç§»å‹•
# â‘§ è¦ªè¦ç´ ã‚’å–å¾—(CSSã‚»ãƒ¬ã‚¯ã‚¿ã§ã¯ã§ããªã„!)
# priceã®è¦ªè¦ç´ (.product-info)ã‚’å–å¾—
price_parent = driver.find_element(By.XPATH, "//span[@class='price']/parent::div")

# â‘¨ ç¥–å…ˆè¦ç´ ã‚’å–å¾—
# priceã®ç¥–å…ˆã®.product-cardã‚’å–å¾—
product_card = driver.find_element(By.XPATH, "//span[@class='price']/ancestor::article")

# â‘© å…„å¼Ÿè¦ç´ ã‚’å–å¾—
# product-titleã®æ¬¡ã®å…„å¼Ÿè¦ç´ 
next_sibling = driver.find_element(By.XPATH, "//h2[@class='product-title']/following-sibling::span")

# â‘ª å­å­«è¦ç´ 
# .product-cardå†…ã®å…¨ã¦ã®span
spans = driver.find_elements(By.XPATH, "//article[@class='product-card']//span")

å±æ€§ã®æ¡ä»¶æŒ‡å®š
# â‘« å±æ€§ãŒå­˜åœ¨ã™ã‚‹
elements_with_data_id = driver.find_elements(By.XPATH, "//*[@data-id]")

# â‘¬ å±æ€§å€¤ãŒéƒ¨åˆ†ä¸€è‡´
# classå±æ€§ã«"product"ã‚’å«ã‚€
products = driver.find_elements(By.XPATH, "//*[contains(@class, 'product')]")

# â‘­ å±æ€§å€¤ãŒå‰æ–¹ä¸€è‡´
# classå±æ€§ãŒ"btn-"ã§å§‹ã¾ã‚‹
buttons = driver.find_elements(By.XPATH, "//button[starts-with(@class, 'btn-')]")

# â‘® è¤‡æ•°å±æ€§æ¡ä»¶
# data-priceå±æ€§ã‚’æŒã¡ã€ã‹ã¤class='price'
prices = driver.find_elements(By.XPATH, "//span[@class='price' and @data-price]")

ä½ç½®æŒ‡å®š
# â‘¯ æœ€åˆã®è¦ç´ 
first_product = driver.find_element(By.XPATH, "(//article[@class='product-card'])[1]")

# â‘° æœ€å¾Œã®è¦ç´ 
last_product = driver.find_element(By.XPATH, "(//article[@class='product-card'])[last()]")

# â‘± 2ç•ªç›®ã®è¦ç´ 
second_product = driver.find_element(By.XPATH, "(//article[@class='product-card'])[2]")

# â‘² ä½ç½®ã§çµã‚Šè¾¼ã¿
# .product-listå†…ã®2ç•ªç›®ã®article
second_in_list = driver.find_element(By.XPATH, "//div[@class='product-list']/article[2]")


ğŸ’¡ 4. å®Ÿè·µçš„ãªã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰ä¾‹
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time

# ãƒ‰ãƒ©ã‚¤ãƒãƒ¼è¨­å®š
options = webdriver.ChromeOptions()
options.add_argument('--headless')  # ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ãƒ¢ãƒ¼ãƒ‰
driver = webdriver.Chrome(options=options)

try:
    # ãƒšãƒ¼ã‚¸ã‚’é–‹ã
    driver.get("https://example-shop.com")
    
    # ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å¾…æ©Ÿ(é‡è¦!)
    wait = WebDriverWait(driver, 10)
    wait.until(EC.presence_of_element_located((By.CSS_SELECTOR, ".product-card")))
    
    # å…¨å•†å“ã‚«ãƒ¼ãƒ‰ã‚’å–å¾—
    products = driver.find_elements(By.CSS_SELECTOR, ".product-card")
    
    product_data = []
    
    for product in products:
        # å„å•†å“ã®æƒ…å ±ã‚’æŠ½å‡º
        try:
            # ã‚¿ã‚¤ãƒˆãƒ«
            title = product.find_element(By.CSS_SELECTOR, ".product-title").text
            
            # ä¾¡æ ¼(data-priceå±æ€§ã‹ã‚‰æ•°å€¤ã‚’å–å¾—)
            price_element = product.find_element(By.CSS_SELECTOR, ".price")
            price = price_element.get_attribute("data-price")
            
            # ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°(XPathã§ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º)
            review_text = product.find_element(
                By.XPATH, ".//span[@class='review-count']"
            ).text
            review_count = review_text.strip("()ä»¶")
            
            # å•†å“IDã‚’å–å¾—
            product_id = product.get_attribute("data-id")
            
            # ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´
            product_data.append({
                "id": product_id,
                "title": title,
                "price": int(price),
                "reviews": int(review_count)
            })
            
        except Exception as e:
            print(f"å•†å“ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼: {e}")
            continue
    
    # çµæœã‚’è¡¨ç¤º
    for item in product_data:
        print(f"ID: {item['id']}")
        print(f"å•†å“å: {item['title']}")
        print(f"ä¾¡æ ¼: Â¥{item['price']:,}")
        print(f"ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°: {item['reviews']}ä»¶")
        print("-" * 40)

finally:
    driver.quit()


ğŸ“ 5. ãƒ—ãƒ­ã®ã‚³ãƒ„ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
â‘  å¾…æ©Ÿå‡¦ç†ã‚’å¿…ãšå…¥ã‚Œã‚‹
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

# æ˜ç¤ºçš„å¾…æ©Ÿ(æ¨å¥¨)
wait = WebDriverWait(driver, 10)
element = wait.until(
    EC.presence_of_element_located((By.CSS_SELECTOR, ".product-card"))
)

# æš—é»™çš„å¾…æ©Ÿ(ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®š)
driver.implicitly_wait(10)

â‘¡ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
from selenium.common.exceptions import NoSuchElementException, TimeoutException

try:
    element = driver.find_element(By.CSS_SELECTOR, ".might-not-exist")
except NoSuchElementException:
    print("è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ")
except TimeoutException:
    print("ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ")

â‘¢ ã‚»ãƒ¬ã‚¯ã‚¿ã®å„ªå…ˆé †ä½
ID â†’ æœ€é€Ÿãƒ»ä¸€æ„æ€§ãŒé«˜ã„
CSSã‚»ãƒ¬ã‚¯ã‚¿ â†’ ãƒãƒ©ãƒ³ã‚¹ãŒè‰¯ã„
XPath â†’ æŸ”è»Ÿæ€§ãŒå¿…è¦ãªæ™‚
â‘£ å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æ‰±ã„
# JavaScriptã§è¿½åŠ ã•ã‚Œã‚‹è¦ç´ ã‚’å¾…ã¤
wait.until(
    EC.visibility_of_element_located((By.CSS_SELECTOR, ".lazy-loaded"))
)

# ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦é…å»¶èª­ã¿è¾¼ã¿
driver.execute_script("window.scrollTo(0, document.body.scrollHeight);")
time.sleep(2)


âš ï¸ ã‚ˆãã‚ã‚‹é–“é•ã„ã¨è§£æ±ºæ³•
é–“é•ã„ âŒ
# è¦ç´ ãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹å‰ã«ã‚¢ã‚¯ã‚»ã‚¹
driver.get(url)
element = driver.find_element(By.CSS_SELECTOR, ".product")  # ã‚¨ãƒ©ãƒ¼!

æ­£è§£ âœ…
driver.get(url)
wait = WebDriverWait(driver, 10)
element = wait.until(
    EC.presence_of_element_located((By.CSS_SELECTOR, ".product"))
)


ã“ã‚Œã§åŸºç¤ã‹ã‚‰å®Ÿè·µã¾ã§ç¶²ç¾…ã§ãã¾ã—ãŸ!
 ä½•ã‹å…·ä½“çš„ãªè³ªå•ãŒã‚ã‚Œã°ã€ãŠæ°—è»½ã«ã©ã†ã ğŸ˜Š
ECã‚µã‚¤ãƒˆã®HTMLéšå±¤æ§‹é€  å®Œå…¨è§£èª¬ ğŸ—ï¸
å®Ÿéš›ã®ECã‚µã‚¤ãƒˆã«ã‚ˆãã‚ã‚‹è¤‡é›‘ãªéšå±¤æ§‹é€ ã‚’ã€ãƒ¬ãƒ™ãƒ«åˆ¥ã«è©³ã—ãè§£èª¬ã—ã¾ã™!

ğŸ“Š å…¨ä½“æ§‹é€ ã®å¯è¦–åŒ–
html (ãƒ«ãƒ¼ãƒˆ)
â””â”€â”€ body
    â””â”€â”€ div#wrapper
        â”œâ”€â”€ header.site-header (ãƒ˜ãƒƒãƒ€ãƒ¼)
        â”‚   â”œâ”€â”€ div.header-top
        â”‚   â”‚   â”œâ”€â”€ div.logo
        â”‚   â”‚   â””â”€â”€ div.header-search
        â”‚   â””â”€â”€ nav.main-nav
        â”‚       â””â”€â”€ ul.nav-menu
        â”‚           â””â”€â”€ li.nav-item Ã— è¤‡æ•°
        â”‚
        â”œâ”€â”€ main#content (ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„)
        â”‚   â”œâ”€â”€ aside.sidebar (ã‚µã‚¤ãƒ‰ãƒãƒ¼)
        â”‚   â”‚   â””â”€â”€ div.filter-section Ã— è¤‡æ•°
        â”‚   â”‚
        â”‚   â””â”€â”€ section.product-section
        â”‚       â”œâ”€â”€ div.section-header
        â”‚       â””â”€â”€ div.product-grid
        â”‚           â””â”€â”€ article.product-item Ã— è¤‡æ•°
        â”‚               â”œâ”€â”€ div.product-image
        â”‚               â”œâ”€â”€ div.product-info
        â”‚               â””â”€â”€ div.product-actions
        â”‚
        â””â”€â”€ footer.site-footer (ãƒ•ãƒƒã‚¿ãƒ¼)


ğŸ¯ ãƒ¬ãƒ™ãƒ«1: ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«æ§‹é€ 
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚·ãƒ§ãƒƒãƒ—</title>
</head>
<body>
    <div id="wrapper" class="site-wrapper">
        <!-- ã“ã“ã«å…¨ã¦ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    </div>
</body>
</html>

ã‚»ãƒ¬ã‚¯ã‚¿ä¾‹
# CSSã‚»ãƒ¬ã‚¯ã‚¿
wrapper = driver.find_element(By.CSS_SELECTOR, "#wrapper")
wrapper = driver.find_element(By.CSS_SELECTOR, "div.site-wrapper")

# XPath
wrapper = driver.find_element(By.XPATH, "//div[@id='wrapper']")
wrapper = driver.find_element(By.XPATH, "/html/body/div[@class='site-wrapper']")


ğŸ¯ ãƒ¬ãƒ™ãƒ«2: ãƒ¡ã‚¤ãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³
<div id="wrapper" class="site-wrapper">
    
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="site-header">
        <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç­‰ -->
    </header>
    
    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main id="content" class="main-content">
        <!-- å•†å“ãƒªã‚¹ãƒˆç­‰ -->
    </main>
    
    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer class="site-footer">
        <!-- ãƒ•ãƒƒã‚¿ãƒ¼æƒ…å ± -->
    </footer>
    
</div>

ã‚»ãƒ¬ã‚¯ã‚¿ä¾‹
# CSSã‚»ãƒ¬ã‚¯ã‚¿ - ç›´æ¥ã®å­è¦ç´ ã¨ã—ã¦å–å¾—
header = driver.find_element(By.CSS_SELECTOR, "#wrapper > header")
main = driver.find_element(By.CSS_SELECTOR, "#wrapper > main#content")
footer = driver.find_element(By.CSS_SELECTOR, "#wrapper > footer")

# XPath - wrapperç›´ä¸‹ã®è¦ç´ 
header = driver.find_element(By.XPATH, "//div[@id='wrapper']/header")
main = driver.find_element(By.XPATH, "//div[@id='wrapper']/main[@id='content']")


ğŸ¯ ãƒ¬ãƒ™ãƒ«3: ãƒ˜ãƒƒãƒ€ãƒ¼å†…éƒ¨æ§‹é€ 
<header class="site-header">
    
    <!-- ä¸Šéƒ¨ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="header-top">
        <div class="container">
            <div class="logo">
                <a href="/">
                    <img src="logo.png" alt="ã‚·ãƒ§ãƒƒãƒ—ãƒ­ã‚´">
                </a>
            </div>
            
            <div class="header-search">
                <form class="search-form" action="/search">
                    <input type="text" class="search-input" placeholder="å•†å“ã‚’æ¤œç´¢">
                    <button type="submit" class="search-button">
                        <i class="icon-search"></i>
                    </button>
                </form>
            </div>
            
            <div class="header-actions">
                <a href="/cart" class="cart-link">
                    <i class="icon-cart"></i>
                    <span class="cart-count">3</span>
                </a>
                <a href="/account" class="account-link">
                    <i class="icon-user"></i>
                </a>
            </div>
        </div>
    </div>
    
    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <nav class="main-nav">
        <div class="container">
            <ul class="nav-menu">
                <li class="nav-item active">
                    <a href="/category/electronics">å®¶é›»</a>
                </li>
                <li class="nav-item">
                    <a href="/category/fashion">ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³</a>
                </li>
                <li class="nav-item has-dropdown">
                    <a href="/category/home">ãƒ›ãƒ¼ãƒ ãƒ»ã‚­ãƒƒãƒãƒ³</a>
                    <ul class="dropdown-menu">
                        <li><a href="/category/home/furniture">å®¶å…·</a></li>
                        <li><a href="/category/home/kitchen">ã‚­ãƒƒãƒãƒ³ç”¨å“</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </nav>
    
</header>

ã‚»ãƒ¬ã‚¯ã‚¿ä¾‹ï¼ˆéšå±¤æŒ‡å®šï¼‰
# ===== ãƒ­ã‚´ç”»åƒã‚’å–å¾— =====
# CSSã‚»ãƒ¬ã‚¯ã‚¿: headerå†…ã®logoå†…ã®img
logo_img = driver.find_element(By.CSS_SELECTOR, "header.site-header .logo img")

# XPath: åŒã˜éšå±¤ã‚’æ˜ç¤º
logo_img = driver.find_element(By.XPATH, 
    "//header[@class='site-header']//div[@class='logo']//img")


# ===== æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã‚’å–å¾— =====
# CSSã‚»ãƒ¬ã‚¯ã‚¿: search-formå†…ã®input
search_input = driver.find_element(By.CSS_SELECTOR, ".search-form .search-input")

# XPath: éšå±¤ã‚’æ˜ç¢ºã«
search_input = driver.find_element(By.XPATH, 
    "//form[@class='search-form']/input[@class='search-input']")


# ===== ã‚«ãƒ¼ãƒˆæ•°ã‚’å–å¾— =====
# CSSã‚»ãƒ¬ã‚¯ã‚¿: cart-linkå†…ã®span
cart_count = driver.find_element(By.CSS_SELECTOR, ".cart-link .cart-count").text

# XPath: ãƒ†ã‚­ã‚¹ãƒˆå–å¾—
cart_count = driver.find_element(By.XPATH, 
    "//a[@class='cart-link']/span[@class='cart-count']").text


# ===== å…¨ãƒŠãƒ“ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã‚’å–å¾— =====
# CSSã‚»ãƒ¬ã‚¯ã‚¿: nav-menuç›´ä¸‹ã®li
nav_items = driver.find_elements(By.CSS_SELECTOR, ".main-nav .nav-menu > li.nav-item")

# XPath: ç›´ä¸‹ã®å­è¦ç´ ã®ã¿
nav_items = driver.find_elements(By.XPATH, 
    "//nav[@class='main-nav']//ul[@class='nav-menu']/li[@class='nav-item']")


# ===== ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›® =====
# CSSã‚»ãƒ¬ã‚¯ã‚¿: è¤‡æ•°ã‚¯ãƒ©ã‚¹æŒ‡å®š
active_nav = driver.find_element(By.CSS_SELECTOR, ".nav-item.active a")

# XPath: è¤‡æ•°æ¡ä»¶
active_nav = driver.find_element(By.XPATH, 
    "//li[contains(@class, 'nav-item') and contains(@class, 'active')]/a")


ğŸ¯ ãƒ¬ãƒ™ãƒ«4: ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆæœ€é‡è¦!ï¼‰
<main id="content" class="main-content">
    <div class="container">
        
        <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼‰ -->
        <aside class="sidebar">
            
            <!-- ã‚«ãƒ†ã‚´ãƒªãƒ¼ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
            <div class="filter-section" data-filter-type="category">
                <h3 class="filter-title">ã‚«ãƒ†ã‚´ãƒªãƒ¼</h3>
                <ul class="filter-list">
                    <li class="filter-item">
                        <input type="checkbox" id="cat-1" value="electronics">
                        <label for="cat-1">å®¶é›» <span class="count">(156)</span></label>
                    </li>
                    <li class="filter-item">
                        <input type="checkbox" id="cat-2" value="fashion">
                        <label for="cat-2">ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ <span class="count">(89)</span></label>
                    </li>
                </ul>
            </div>
            
            <!-- ä¾¡æ ¼ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
            <div class="filter-section" data-filter-type="price">
                <h3 class="filter-title">ä¾¡æ ¼å¸¯</h3>
                <ul class="filter-list">
                    <li class="filter-item">
                        <input type="radio" name="price" id="price-1" value="0-5000">
                        <label for="price-1">Â¥0 - Â¥5,000</label>
                    </li>
                    <li class="filter-item">
                        <input type="radio" name="price" id="price-2" value="5000-10000">
                        <label for="price-2">Â¥5,000 - Â¥10,000</label>
                    </li>
                </ul>
            </div>
            
        </aside>
        
        <!-- å•†å“ã‚¨ãƒªã‚¢ -->
        <section class="product-section">
            
            <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ -->
            <div class="section-header">
                <h1 class="section-title">ãŠã™ã™ã‚å•†å“</h1>
                <div class="sort-options">
                    <select class="sort-select" name="sort">
                        <option value="popular">äººæ°—é †</option>
                        <option value="price-asc">ä¾¡æ ¼: å®‰ã„é †</option>
                        <option value="price-desc">ä¾¡æ ¼: é«˜ã„é †</option>
                    </select>
                </div>
            </div>
            
            <!-- å•†å“ã‚°ãƒªãƒƒãƒ‰ -->
            <div class="product-grid">
                
                <!-- å•†å“ã‚¢ã‚¤ãƒ†ãƒ 1 -->
                <article class="product-item" data-product-id="12345" data-category="electronics">
                    
                    <!-- å•†å“ç”»åƒã‚¨ãƒªã‚¢ -->
                    <div class="product-image">
                        <a href="/product/12345">
                            <img src="product1.jpg" alt="ãƒ¯ã‚¤ãƒ¤ãƒ¬ã‚¹ã‚¤ãƒ¤ãƒ›ãƒ³ ProSound X1" 
                                 class="main-image" loading="lazy">
                        </a>
                        <div class="product-badges">
                            <span class="badge badge-new">æ–°å•†å“</span>
                            <span class="badge badge-sale">10% OFF</span>
                        </div>
                        <button class="btn-wishlist" data-product-id="12345">
                            <i class="icon-heart"></i>
                        </button>
                    </div>
                    
                    <!-- å•†å“æƒ…å ±ã‚¨ãƒªã‚¢ -->
                    <div class="product-info">
                        <div class="product-category">
                            <a href="/category/electronics">å®¶é›»ãƒ»ã‚ªãƒ¼ãƒ‡ã‚£ã‚ª</a>
                        </div>
                        
                        <h2 class="product-title">
                            <a href="/product/12345">ãƒ¯ã‚¤ãƒ¤ãƒ¬ã‚¹ã‚¤ãƒ¤ãƒ›ãƒ³ ProSound X1</a>
                        </h2>
                        
                        <div class="product-rating">
                            <div class="stars" data-rating="4.5">
                                <span class="star filled">â˜…</span>
                                <span class="star filled">â˜…</span>
                                <span class="star filled">â˜…</span>
                                <span class="star filled">â˜…</span>
                                <span class="star half">â˜…</span>
                            </div>
                            <span class="rating-score">4.5</span>
                            <span class="review-count">(248ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼)</span>
                        </div>
                        
                        <div class="product-price">
                            <span class="price-original" data-price="6980">Â¥6,980</span>
                            <span class="price-current" data-price="5980">Â¥5,980</span>
                            <span class="discount-rate">14%OFF</span>
                        </div>
                        
                        <div class="product-features">
                            <ul class="feature-list">
                                <li class="feature-item">
                                    <i class="icon-check"></i>é€æ–™ç„¡æ–™
                                </li>
                                <li class="feature-item">
                                    <i class="icon-check"></i>ç¿Œæ—¥é…é€
                                </li>
                                <li class="feature-item">
                                    <i class="icon-check"></i>ãƒã‚¤ãƒ³ãƒˆ10å€
                                </li>
                            </ul>
                        </div>
                        
                        <div class="stock-info">
                            <span class="stock-status in-stock">åœ¨åº«ã‚ã‚Š</span>
                            <span class="stock-quantity">æ®‹ã‚Š15å€‹</span>
                        </div>
                    </div>
                    
                    <!-- å•†å“ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¨ãƒªã‚¢ -->
                    <div class="product-actions">
                        <button class="btn btn-primary btn-add-cart" 
                                data-product-id="12345" 
                                data-product-name="ãƒ¯ã‚¤ãƒ¤ãƒ¬ã‚¹ã‚¤ãƒ¤ãƒ›ãƒ³ ProSound X1"
                                data-price="5980">
                            <i class="icon-cart"></i>
                            ã‚«ãƒ¼ãƒˆã«å…¥ã‚Œã‚‹
                        </button>
                        
                        <button class="btn btn-secondary btn-quick-view" 
                                data-product-id="12345">
                            <i class="icon-eye"></i>
                            ã‚¯ã‚¤ãƒƒã‚¯ãƒ“ãƒ¥ãƒ¼
                        </button>
                    </div>
                    
                </article>
                
                <!-- å•†å“ã‚¢ã‚¤ãƒ†ãƒ 2 -->
                <article class="product-item" data-product-id="12346" data-category="electronics">
                    <div class="product-image">
                        <a href="/product/12346">
                            <img src="product2.jpg" alt="ã‚¹ãƒãƒ¼ãƒˆã‚¦ã‚©ãƒƒãƒ FitTime Pro" 
                                 class="main-image" loading="lazy">
                        </a>
                        <div class="product-badges">
                            <span class="badge badge-bestseller">ãƒ™ã‚¹ãƒˆã‚»ãƒ©ãƒ¼</span>
                        </div>
                    </div>
                    
                    <div class="product-info">
                        <div class="product-category">
                            <a href="/category/electronics">å®¶é›»ãƒ»ã‚¦ã‚§ã‚¢ãƒ©ãƒ–ãƒ«</a>
                        </div>
                        
                        <h2 class="product-title">
                            <a href="/product/12346">ã‚¹ãƒãƒ¼ãƒˆã‚¦ã‚©ãƒƒãƒ FitTime Pro</a>
                        </h2>
                        
                        <div class="product-rating">
                            <div class="stars" data-rating="5">
                                <span class="star filled">â˜…</span>
                                <span class="star filled">â˜…</span>
                                <span class="star filled">â˜…</span>
                                <span class="star filled">â˜…</span>
                                <span class="star filled">â˜…</span>
                            </div>
                            <span class="rating-score">5.0</span>
                            <span class="review-count">(512ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼)</span>
                        </div>
                        
                        <div class="product-price">
                            <span class="price-current" data-price="12800">Â¥12,800</span>
                        </div>
                        
                        <div class="stock-info">
                            <span class="stock-status low-stock">æ®‹ã‚Šã‚ãšã‹</span>
                            <span class="stock-quantity">æ®‹ã‚Š3å€‹</span>
                        </div>
                    </div>
                    
                    <div class="product-actions">
                        <button class="btn btn-primary btn-add-cart" 
                                data-product-id="12346" 
                                data-price="12800">
                            ã‚«ãƒ¼ãƒˆã«å…¥ã‚Œã‚‹
                        </button>
                    </div>
                </article>
                
                <!-- å•†å“ã‚¢ã‚¤ãƒ†ãƒ 3 -->
                <article class="product-item" data-product-id="12347" data-category="fashion">
                    <div class="product-image">
                        <a href="/product/12347">
                            <img src="product3.jpg" alt="ãƒ¬ã‚¶ãƒ¼ãƒãƒƒã‚¯ãƒ‘ãƒƒã‚¯ Classic" 
                                 class="main-image" loading="lazy">
                        </a>
                    </div>
                    
                    <div class="product-info">
                        <div class="product-category">
                            <a href="/category/fashion">ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ãƒ»ãƒãƒƒã‚°</a>
                        </div>
                        
                        <h2 class="product-title">
                            <a href="/product/12347">ãƒ¬ã‚¶ãƒ¼ãƒãƒƒã‚¯ãƒ‘ãƒƒã‚¯ Classic</a>
                        </h2>
                        
                        <div class="product-rating">
                            <div class="stars" data-rating="4">
                                <span class="star filled">â˜…</span>
                                <span class="star filled">â˜…</span>
                                <span class="star filled">â˜…</span>
                                <span class="star filled">â˜…</span>
                                <span class="star empty">â˜†</span>
                            </div>
                            <span class="rating-score">4.0</span>
                            <span class="review-count">(89ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼)</span>
                        </div>
                        
                        <div class="product-price">
                            <span class="price-current" data-price="8900">Â¥8,900</span>
                        </div>
                        
                        <div class="stock-info">
                            <span class="stock-status out-of-stock">å£²ã‚Šåˆ‡ã‚Œ</span>
                        </div>
                    </div>
                    
                    <div class="product-actions">
                        <button class="btn btn-disabled" disabled>
                            å£²ã‚Šåˆ‡ã‚Œ
                        </button>
                    </div>
                </article>
                
            </div>
            
            <!-- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ -->
            <div class="pagination">
                <a href="?page=1" class="page-link disabled">å‰ã¸</a>
                <a href="?page=1" class="page-link active">1</a>
                <a href="?page=2" class="page-link">2</a>
                <a href="?page=3" class="page-link">3</a>
                <a href="?page=2" class="page-link">æ¬¡ã¸</a>
            </div>
            
        </section>
        
    </div>
</main>


ğŸ” å…·ä½“çš„ãªéšå±¤æŒ‡å®šã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ä¾‹
ä¾‹1: å•†å“ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—ï¼ˆè¤‡æ•°éšå±¤ï¼‰
# ===== æ–¹æ³•1: CSSã‚»ãƒ¬ã‚¯ã‚¿ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰ =====
titles = driver.find_elements(By.CSS_SELECTOR, ".product-item .product-info .product-title a")

# ===== æ–¹æ³•2: CSSã‚»ãƒ¬ã‚¯ã‚¿ï¼ˆæ®µéšçš„ï¼‰ =====
# â‘  ã¾ãšå•†å“ã‚°ãƒªãƒƒãƒ‰
grid = driver.find_element(By.CSS_SELECTOR, ".product-grid")
# â‘¡ ãã®ä¸­ã®å•†å“ã‚¢ã‚¤ãƒ†ãƒ 
items = grid.find_elements(By.CSS_SELECTOR, ".product-item")
# â‘¢ å„ã‚¢ã‚¤ãƒ†ãƒ ã‹ã‚‰ã‚¿ã‚¤ãƒˆãƒ«
for item in items:
    title = item.find_element(By.CSS_SELECTOR, ".product-info .product-title a").text
    print(title)

# ===== æ–¹æ³•3: XPathï¼ˆéšå±¤æ˜ç¤ºï¼‰ =====
titles = driver.find_elements(By.XPATH, 
    "//div[@class='product-grid']"
    "//article[@class='product-item']"
    "//div[@class='product-info']"
    "//h2[@class='product-title']"
    "/a"
)

# ===== æ–¹æ³•4: XPathï¼ˆè¦ªã‹ã‚‰å­ã¸é †ç•ªã«ï¼‰ =====
titles = driver.find_elements(By.XPATH, 
    "//section[@class='product-section']"
    "/div[@class='product-grid']"
    "/article[@class='product-item']"
    "/div[@class='product-info']"
    "/h2[@class='product-title']"
    "/a"
)

ä¾‹2: ä¾¡æ ¼æƒ…å ±ã‚’å–å¾—ï¼ˆè¤‡é›‘ãªéšå±¤ï¼‰
# ===== ç¾åœ¨ä¾¡æ ¼ã‚’å–å¾— =====
# CSSã‚»ãƒ¬ã‚¯ã‚¿: å±æ€§ã‚‚å–å¾—
prices = driver.find_elements(By.CSS_SELECTOR, ".product-item .product-price .price-current")
for price in prices:
    # ãƒ†ã‚­ã‚¹ãƒˆ: "Â¥5,980"
    price_text = price.text
    # data-priceå±æ€§: "5980"
    price_value = price.get_attribute("data-price")
    print(f"è¡¨ç¤º: {price_text}, æ•°å€¤: {price_value}")

# XPath: data-priceå±æ€§ãŒã‚ã‚‹è¦ç´ ã®ã¿
prices = driver.find_elements(By.XPATH, 
    "//article[@class='product-item']"
    "//div[@class='product-price']"
    "//span[@class='price-current' and @data-price]"
)

# ===== å‰²å¼•ç‡ãŒã‚ã‚‹å•†å“ã®ã¿å–å¾— =====
# CSSã‚»ãƒ¬ã‚¯ã‚¿: è¦ªè¦ç´ ã‹ã‚‰è¾¿ã‚‹
discount_products = driver.find_elements(By.CSS_SELECTOR, 
    ".product-item:has(.discount-rate)")

# XPath: å‰²å¼•ç‡ã‚’å«ã‚€å•†å“
discount_products = driver.find_elements(By.XPATH, 
    "//article[@class='product-item'][.//span[@class='discount-rate']]"
)

ä¾‹3: ãƒ¬ãƒ“ãƒ¥ãƒ¼æƒ…å ±ã‚’éšå±¤çš„ã«å–å¾—
# ===== è©•ä¾¡ã‚¹ã‚³ã‚¢ã¨ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°ã‚’ã‚»ãƒƒãƒˆã§å–å¾— =====
products = driver.find_elements(By.CSS_SELECTOR, ".product-item")

for product in products:
    # å•†å“ID
    product_id = product.get_attribute("data-product-id")
    
    # è©•ä¾¡ã‚¨ãƒªã‚¢å…¨ä½“ã‚’å–å¾—
    rating_section = product.find_element(By.CSS_SELECTOR, ".product-rating")
    
    # ãã®ä¸­ã‹ã‚‰ã‚¹ã‚³ã‚¢
    rating_score = rating_section.find_element(By.CSS_SELECTOR, ".rating-score").text
    
    # ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°ï¼ˆãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰æ•°å€¤æŠ½å‡ºï¼‰
    review_text = rating_section.find_element(By.CSS_SELECTOR, ".review-count").text
    # "(248ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼)" â†’ "248"
    review_count = review_text.strip("()ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼")
    
    print(f"å•†å“ID: {product_id}, è©•ä¾¡: {rating_score}, ãƒ¬ãƒ“ãƒ¥ãƒ¼: {review_count}")

# ===== XPathã§æ˜Ÿã®æ•°ã‚’å–å¾— =====
# data-ratingå±æ€§ã‹ã‚‰è©•ä¾¡ã‚’å–å¾—
ratings = driver.find_elements(By.XPATH, 
    "//article[@class='product-item']"
    "//div[@class='product-rating']"
    "//div[@class='stars']"
)
for rating in ratings:
    score = rating.get_attribute("data-rating")
    print(f"è©•ä¾¡: {score}ç‚¹")

ä¾‹4: ãƒãƒƒã‚¸æƒ…å ±ã‚’å–å¾—ï¼ˆæ¡ä»¶ä»˜ãï¼‰
# ===== ã€Œæ–°å•†å“ã€ãƒãƒƒã‚¸ãŒã‚ã‚‹å•†å“ã®ã¿ =====
# CSSã‚»ãƒ¬ã‚¯ã‚¿
new_products = driver.find_elements(By.CSS_SELECTOR, 
    ".product-item:has(.badge-new)")

# XPath
new_products = driver.find_elements(By.XPATH, 
    "//article[@class='product-item'][.//span[@class='badge badge-new']]"
)

# ===== å•†å“ã”ã¨ã«å…¨ãƒãƒƒã‚¸ã‚’å–å¾— =====
products = driver.find_elements(By.CSS_SELECTOR, ".product-item")

for product in products:
    product_id = product.get_attribute("data-product-id")
    
    # ãƒãƒƒã‚¸ã‚¨ãƒªã‚¢ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
    try:
        badge_area = product.find_element(By.CSS_SELECTOR, ".product-badges")
        badges = badge_area.find_elements(By.CSS_SELECTOR, ".badge")
        badge_texts = [badge.text for badge in badges]
        print(f"å•†å“ID {product_id}: {', '.join(badge_texts)}")
    except:
        print(f"å•†å“ID {product_id}: ãƒãƒƒã‚¸ãªã—")

ä¾‹5: åœ¨åº«çŠ¶æ³ã‚’å–å¾—ï¼ˆæ·±ã„éšå±¤ï¼‰
# ===== åœ¨åº«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å–å¾— =====
# CSSã‚»ãƒ¬ã‚¯ã‚¿: è¤‡æ•°éšå±¤
stock_elements = driver.find_elements(By.CSS_SELECTOR, 
    ".product-item .product-info .stock-info .stock-status")

for stock in stock_elements:
    status_text = stock.text
    status_class = stock.get_attribute("class")
    
    # ã‚¯ãƒ©ã‚¹åã§åˆ¤å®š
    if "in-stock" in status_class:
        print(f"åœ¨åº«ã‚ã‚Š: {status_text}")
    elif "low-stock" in status_class:
        print(f"æ®‹ã‚Šã‚ãšã‹: {status_text}")
    elif "out-of-stock" in status_class:
        print(f"å£²ã‚Šåˆ‡ã‚Œ: {status_text}")

# ===== XPathã§åœ¨åº«æ•°ã‚‚åŒæ™‚å–å¾— =====
products = driver.find_elements(By.XPATH, "//article[@class='product-item']")

for product in products:
    # åœ¨åº«æƒ…å ±ã‚¨ãƒªã‚¢å…¨ä½“
    try:
        stock_status = product.find_element(By.XPATH, 
            ".//div[@class='stock-info']/span[@class='stock-status']").text
        stock_quantity = product.find_element(By.XPATH, 
            ".//div[@class='stock-info']/span[@class='stock-quantity']").text
        
        print(f"çŠ¶æ…‹: {stock_status}, æ•°é‡: {stock_quantity}")
    except:
        print("åœ¨åº«æƒ…å ±ãªã—")


ğŸ“ éšå±¤æŒ‡å®šã®å®Ÿè·µçš„ãƒ‘ã‚¿ãƒ¼ãƒ³
ãƒ‘ã‚¿ãƒ¼ãƒ³1: ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ï¼ˆä¸Šã‹ã‚‰ä¸‹ã¸ï¼‰
# ã‚»ã‚¯ã‚·ãƒ§ãƒ³ â†’ ã‚°ãƒªãƒƒãƒ‰ â†’ ã‚¢ã‚¤ãƒ†ãƒ  â†’ æƒ…å ± ã®é †
section = driver.find_element(By.CSS_SELECTOR, ".product-section")
grid = section.find_element(By.CSS_SELECTOR, ".product-grid")
items = grid.find_elements(By.CSS_SELECTOR, ".product-item")

for item in items:
    info = item.find_element(By.CSS_SELECTOR, ".product-info")
    title = info.find_element(By.CSS_SELECTOR, ".product-title").text

ãƒ‘ã‚¿ãƒ¼ãƒ³2: ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆä¸€æ°—ã«æŒ‡å®šï¼‰
# ä¸€ç™ºã§ç›®çš„ã®è¦ç´ ã¸
titles = driver.find_elements(By.CSS_SELECTOR, 
    ".product-section .product-grid .product-item .product-info .product-title")

ãƒ‘ã‚¿ãƒ¼ãƒ³3: æ¡ä»¶ä»˜ãéšå±¤
# XPath: ç‰¹å®šæ¡ä»¶ã‚’æº€ãŸã™éšå±¤ã®ã¿
# ã€Œåœ¨åº«ã‚ã‚Šã€ã®å•†å“ã®ä¾¡æ ¼ã®ã¿
prices = driver.find_elements(By.XPATH, 
    "//article[@class='product-item']"
    "[.//span[contains(@class, 'in-stock')]]"  # åœ¨åº«ã‚ã‚Šã®æ¡ä»¶
    "//span[@class='price-current']"
)

ãƒ‘ã‚¿ãƒ¼ãƒ³4: å…„å¼Ÿè¦ç´ ã®å–å¾—ï¼ˆXPathç‰¹æœ‰ï¼‰
# ã‚¿ã‚¤ãƒˆãƒ«ã®æ¬¡ã®å…„å¼Ÿè¦ç´ ï¼ˆè©•ä¾¡ã‚¨ãƒªã‚¢ï¼‰ã‚’å–å¾—
rating_areas = driver.find_elements(By.XPATH, 
    "//h2[@class='product-title']/following-sibling::div[@class='product-rating']"
)

# ä¾¡æ ¼ã®è¦ªè¦ç´ ã‚’å–å¾—
price_parents = driver.find_elements(By.XPATH, 
    "//span[@class='price-current']/parent::div"
)


ğŸ’¡ å®Ÿè·µçš„ãªå®Œå…¨ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚³ãƒ¼ãƒ‰
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

driver = webdriver.Chrome()

try:
    driver.get("https://example-shop.com/products")
    
    # å•†å“ã‚°ãƒªãƒƒãƒ‰ã®èª­ã¿è¾¼ã¿ã‚’å¾…æ©Ÿ
    wait = WebDriverWait(driver, 10)
    wait.until(EC.presence_of_element_located((By.CSS_SELECTOR, ".product-grid")))
    
    # å…¨å•†å“ã‚’å–å¾—
    products = driver.find_elements(By.CSS_SELECTOR, ".product-item")
    
    product_list = []
    
    for product in products:
        data = {}
        
        # å•†å“IDï¼ˆå±æ€§ã‹ã‚‰ï¼‰
        data['id'] = product.get_attribute("data-product-id")
        data['category'] = product.get_attribute("data-category")
        
        # ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆéšå±¤: product â†’ product-info â†’ product-title â†’ aï¼‰
        data['title'] = product.find_element(
            By.CSS_SELECTOR, ".product-info .product-title a"
        ).text
        
        # ä¾¡æ ¼ï¼ˆéšå±¤: product â†’ product-info â†’ product-price â†’ price-currentï¼‰
        price_elem = product.find_element(
            By.CSS_SELECTOR, ".product-info .product-price .price-current"
        )
        data['price'] = int(price_elem.get_attribute("data-price"))
        
        # è©•ä¾¡ï¼ˆéšå±¤: product â†’ product-info â†’ product-ratingï¼‰
        try:
            rating_area = product.find_element(By.CSS_SELECTOR, ".product-rating")
            data['rating'] = rating_area.find_element(
                By.CSS_SELECTOR, ".rating-score"
            ).text
            review_text = rating_area.find_element(
                By.CSS_SELECTOR, ".review-count"
            ).text
            data['reviews'] = int(review_text.strip("()ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼"))
        except:
            data['rating'] = None
            data['reviews'] = 0
        
        # ãƒãƒƒã‚¸ï¼ˆéšå±¤: product â†’ product-image â†’ product-badges â†’ badgeï¼‰
        try:
            badges
ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼
ğŸ“ æœ€çµ‚ã¾ã¨ã‚ï¼šåº§æ¨™æŒ‡å®šã®å…¨æ‰‹æ³•ï¼ˆç¶šãï¼‰
æ‰‹æ³•ã®æ¯”è¼ƒè¡¨
æ‰‹æ³•
é›£æ˜“åº¦
ç²¾åº¦
é€Ÿåº¦
ç”¨é€”
ActionChains
â­â­
â­â­â­â­
â­â­â­â­
Canvasè¦ç´ ã€ç›¸å¯¾åº§æ¨™
JavaScriptåº§æ¨™ã‚¯ãƒªãƒƒã‚¯
â­â­â­
â­â­â­â­â­
â­â­â­â­â­
å‹•çš„è¦ç´ ã€iframe
PyAutoGUI
â­
â­â­â­
â­â­â­
OSå…¨ä½“ã€ç”»åƒèªè­˜
ç”»åƒèªè­˜ (OpenCV)
â­â­â­â­
â­â­â­
â­â­
UIã®å¤‰åŒ–ã«å¼·ã„
åº§æ¨™ãƒãƒƒãƒ”ãƒ³ã‚°
â­â­â­
â­â­â­â­
â­â­â­â­
è¤‡é›‘ãªã‚²ãƒ¼ãƒ 
ã‚°ãƒªãƒƒãƒ‰ã‚·ã‚¹ãƒ†ãƒ 
â­â­
â­â­â­
â­â­â­â­
ãƒ‡ãƒãƒƒã‚°ã€ãƒ†ã‚¹ãƒˆ


ğŸ”¥ å®Ÿè·µçš„ãªç·åˆã‚µãƒ³ãƒ—ãƒ«
ECã‚µã‚¤ãƒˆå®Œå…¨è‡ªå‹•æ“ä½œ
"""
ECã‚µã‚¤ãƒˆã®å•†å“è³¼å…¥ã‚’åº§æ¨™æŒ‡å®šã§è‡ªå‹•åŒ–ã™ã‚‹å®Œå…¨ãªã‚µãƒ³ãƒ—ãƒ«
"""

import time
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.action_chains import ActionChains
import json

class EcommerceAutomation:
    """ECã‚µã‚¤ãƒˆè‡ªå‹•æ“ä½œã‚¯ãƒ©ã‚¹"""
    
    def __init__(self, base_url, coordinates_file='ecommerce_coords.json'):
        # ãƒ‰ãƒ©ã‚¤ãƒãƒ¼åˆæœŸåŒ–
        self.driver = webdriver.Chrome()
        self.driver.maximize_window()
        self.base_url = base_url
        self.wait = WebDriverWait(self.driver, 10)
        
        # åº§æ¨™ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
        self.load_coordinates(coordinates_file)
        
        # ç”»é¢ã‚µã‚¤ã‚ºã‚’å–å¾—
        self.viewport = self.driver.execute_script("""
            return {
                width: window.innerWidth,
                height: window.innerHeight
            };
        """)
        
        print(f"åˆæœŸåŒ–å®Œäº† - ç”»é¢ã‚µã‚¤ã‚º: {self.viewport['width']}x{self.viewport['height']}")
    
    def load_coordinates(self, filename):
        """åº§æ¨™è¨­å®šã‚’èª­ã¿è¾¼ã¿"""
        try:
            with open(filename, 'r', encoding='utf-8') as f:
                self.coords = json.load(f)
            print(f"åº§æ¨™ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†: {filename}")
        except FileNotFoundError:
            print(f"åº§æ¨™ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {filename}")
            print("ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆåº§æ¨™ã‚’ä½¿ç”¨ã—ã¾ã™")
            self.coords = self._default_coordinates()
    
    def _default_coordinates(self):
        """ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆåº§æ¨™ï¼ˆ1920x1080åŸºæº–ï¼‰"""
        return {
            "home": {
                "search_box": [800, 100],
                "cart_icon": [1800, 80],
                "menu_button": [50, 80]
            },
            "product_list": {
                "first_product": [300, 400],
                "second_product": [700, 400],
                "third_product": [1100, 400],
                "filter_button": [100, 300],
                "sort_dropdown": [1700, 250]
            },
            "product_detail": {
                "add_to_cart": [1400, 650],
                "quantity_plus": [1250, 550],
                "quantity_minus": [1150, 550],
                "size_selector": [1200, 450],
                "color_selector": [1200, 500],
                "reviews_tab": [600, 850],
                "description_tab": [400, 850]
            },
            "cart": {
                "checkout_button": [1500, 900],
                "continue_shopping": [400, 900],
                "remove_item": [1700, 400],
                "update_quantity": [1600, 450],
                "coupon_field": [800, 700],
                "apply_coupon": [1000, 700]
            },
            "checkout": {
                "name_field": [600, 300],
                "email_field": [600, 350],
                "address_field": [600, 400],
                "city_field": [600, 450],
                "zip_field": [600, 500],
                "phone_field": [600, 550],
                "payment_card": [500, 700],
                "payment_paypal": [700, 700],
                "place_order": [800, 900]
            }
        }
    
    def safe_click(self, x, y, description="", retries=3, show_marker=True):
        """
        å®‰å…¨ãªåº§æ¨™ã‚¯ãƒªãƒƒã‚¯
        
        Args:
            x: Xåº§æ¨™
            y: Yåº§æ¨™
            description: æ“ä½œã®èª¬æ˜
            retries: ãƒªãƒˆãƒ©ã‚¤å›æ•°
            show_marker: ãƒãƒ¼ã‚«ãƒ¼è¡¨ç¤º
        """
        for attempt in range(retries):
            try:
                if show_marker:
                    self._show_click_marker(x, y, description)
                
                # ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’ãƒªã‚»ãƒƒãƒˆ
                self.driver.execute_script("window.scrollTo(0, 0);")
                time.sleep(0.2)
                
                # è¦ç´ ã‚’ã‚¯ãƒªãƒƒã‚¯
                element = self.driver.execute_script("""
                    var x = arguments[0];
                    var y = arguments[1];
                    var element = document.elementFromPoint(x, y);
                    
                    if (element) {
                        element.click();
                        return true;
                    }
                    return false;
                """, x, y)
                
                if element:
                    print(f"âœ“ {description} ã‚’ã‚¯ãƒªãƒƒã‚¯: ({x}, {y})")
                    time.sleep(0.5)
                    return True
                else:
                    print(f"âœ— è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ (è©¦è¡Œ {attempt+1}/{retries})")
                    
            except Exception as e:
                print(f"âœ— ã‚¨ãƒ©ãƒ¼: {e} (è©¦è¡Œ {attempt+1}/{retries})")
            
            time.sleep(0.5)
        
        print(f"âœ— {description} ã®ã‚¯ãƒªãƒƒã‚¯ã«å¤±æ•—ã—ã¾ã—ãŸ")
        return False
    
    def _show_click_marker(self, x, y, text=""):
        """ã‚¯ãƒªãƒƒã‚¯ä½ç½®ã«ãƒãƒ¼ã‚«ãƒ¼ã‚’è¡¨ç¤º"""
        self.driver.execute_script("""
            var x = arguments[0];
            var y = arguments[1];
            var text = arguments[2];
            
            var marker = document.createElement('div');
            marker.innerHTML = `
                <div style="
                    position: fixed;
                    left: ${x - 15}px;
                    top: ${y - 15}px;
                    width: 30px;
                    height: 30px;
                    background: rgba(255, 0, 0, 0.6);
                    border: 3px solid red;
                    border-radius: 50%;
                    z-index: 999999;
                    pointer-events: none;
                    animation: pulse 0.5s ease-in-out;
                "></div>
                <div style="
                    position: fixed;
                    left: ${x + 20}px;
                    top: ${y - 10}px;
                    background: rgba(0, 0, 0, 0.9);
                    color: white;
                    padding: 5px 10px;
                    border-radius: 5px;
                    font-size: 12px;
                    z-index: 999999;
                    pointer-events: none;
                ">${text}</div>
            `;
            
            var style = document.createElement('style');
            style.textContent = '@keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.3); } 100% { transform: scale(1); } }';
            document.head.appendChild(style);
            
            document.body.appendChild(marker);
            setTimeout(() => document.body.removeChild(marker), 1500);
        """, x, y, text)
    
    def type_text_at_coordinate(self, x, y, text, description=""):
        """åº§æ¨™ä½ç½®ã§ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›"""
        if self.safe_click(x, y, description):
            time.sleep(0.3)
            
            # ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªè¦ç´ ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›
            self.driver.switch_to.active_element.clear()
            self.driver.switch_to.active_element.send_keys(text)
            
            print(f"  â†’ ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›: {text}")
            time.sleep(0.5)
            return True
        return False
    
    def scroll_to_coordinate(self, y_position):
        """æŒ‡å®šYåº§æ¨™ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«"""
        self.driver.execute_script(f"window.scrollTo(0, {y_position});")
        time.sleep(0.5)
    
    # ===== ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ =====
    
    def navigate_to_home(self):
        """ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã«ç§»å‹•"""
        print("\n=== ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã¸ç§»å‹• ===")
        self.driver.get(self.base_url)
        time.sleep(2)
    
    def search_product(self, keyword):
        """å•†å“æ¤œç´¢"""
        print(f"\n=== å•†å“æ¤œç´¢: {keyword} ===")
        
        coords = self.coords['home']['search_box']
        if self.type_text_at_coordinate(coords[0], coords[1], keyword, "æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹"):
            # Enterã‚­ãƒ¼ã‚’æŠ¼ã™
            self.driver.switch_to.active_element.send_keys("\n")
            time.sleep(2)
            return True
        return False
    
    def select_product(self, position=1):
        """å•†å“ã‚’é¸æŠï¼ˆ1=æœ€åˆã®å•†å“ã€2=2ç•ªç›®...ï¼‰"""
        print(f"\n=== å•†å“é¸æŠ: {position}ç•ªç›® ===")
        
        product_map = {
            1: 'first_product',
            2: 'second_product',
            3: 'third_product'
        }
        
        product_key = product_map.get(position, 'first_product')
        coords = self.coords['product_list'][product_key]
        
        # ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦å•†å“ã‚’è¡¨ç¤º
        self.scroll_to_coordinate(300)
        
        if self.safe_click(coords[0], coords[1], f"{position}ç•ªç›®ã®å•†å“"):
            time.sleep(2)
            return True
        return False
    
    def add_to_cart(self, quantity=1):
        """ã‚«ãƒ¼ãƒˆã«è¿½åŠ """
        print(f"\n=== ã‚«ãƒ¼ãƒˆã«è¿½åŠ : æ•°é‡ {quantity} ===")
        
        # æ•°é‡ã‚’èª¿æ•´
        if quantity > 1:
            plus_coords = self.coords['product_detail']['quantity_plus']
            for i in range(quantity - 1):
                self.safe_click(plus_coords[0], plus_coords[1], 
                               f"æ•°é‡å¢—åŠ  ({i+2}/{quantity})", show_marker=False)
                time.sleep(0.3)
        
        # ã‚«ãƒ¼ãƒˆã«è¿½åŠ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
        add_coords = self.coords['product_detail']['add_to_cart']
        if self.safe_click(add_coords[0], add_coords[1], "ã‚«ãƒ¼ãƒˆã«è¿½åŠ ãƒœã‚¿ãƒ³"):
            time.sleep(2)
            return True
        return False
    
    def go_to_cart(self):
        """ã‚«ãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã¸ç§»å‹•"""
        print("\n=== ã‚«ãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã¸ç§»å‹• ===")
        
        coords = self.coords['home']['cart_icon']
        if self.safe_click(coords[0], coords[1], "ã‚«ãƒ¼ãƒˆã‚¢ã‚¤ã‚³ãƒ³"):
            time.sleep(2)
            return True
        return False
    
    def proceed_to_checkout(self):
        """ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã¸é€²ã‚€"""
        print("\n=== ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã¸ ===")
        
        # ãƒšãƒ¼ã‚¸ä¸‹éƒ¨ã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
        self.scroll_to_coordinate(800)
        
        coords = self.coords['cart']['checkout_button']
        if self.safe_click(coords[0], coords[1], "ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆãƒœã‚¿ãƒ³"):
            time.sleep(2)
            return True
        return False
    
    def fill_checkout_form(self, customer_info):
        """ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’å…¥åŠ›"""
        print("\n=== ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæƒ…å ±å…¥åŠ› ===")
        
        checkout_coords = self.coords['checkout']
        
        # å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å…¥åŠ›
        fields = [
            ('name_field', customer_info.get('name', ''), 'åå‰'),
            ('email_field', customer_info.get('email', ''), 'ãƒ¡ãƒ¼ãƒ«'),
            ('address_field', customer_info.get('address', ''), 'ä½æ‰€'),
            ('city_field', customer_info.get('city', ''), 'å¸‚åŒºç”ºæ‘'),
            ('zip_field', customer_info.get('zip', ''), 'éƒµä¾¿ç•ªå·'),
            ('phone_field', customer_info.get('phone', ''), 'é›»è©±ç•ªå·')
        ]
        
        for field_key, value, description in fields:
            coords = checkout_coords[field_key]
            self.type_text_at_coordinate(coords[0], coords[1], value, description)
            time.sleep(0.3)
        
        return True
    
    def select_payment_method(self, method='card'):
        """æ”¯æ‰•ã„æ–¹æ³•ã‚’é¸æŠ"""
        print(f"\n=== æ”¯æ‰•ã„æ–¹æ³•é¸æŠ: {method} ===")
        
        self.scroll_to_coordinate(600)
        
        method_map = {
            'card': 'payment_card',
            'paypal': 'payment_paypal'
        }
        
        method_key = method_map.get(method, 'payment_card')
        coords = self.coords['checkout'][method_key]
        
        if self.safe_click(coords[0], coords[1], f"æ”¯æ‰•ã„æ–¹æ³•: {method}"):
            time.sleep(1)
            return True
        return False
    
    def place_order(self, confirm=True):
        """æ³¨æ–‡ã‚’ç¢ºå®š"""
        if not confirm:
            print("æ³¨æ–‡ç¢ºå®šã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã—ãŸ")
            return False
        
        print("\n=== æ³¨æ–‡ç¢ºå®š ===")
        
        self.scroll_to_coordinate(850)
        
        coords = self.coords['checkout']['place_order']
        if self.safe_click(coords[0], coords[1], "æ³¨æ–‡ç¢ºå®šãƒœã‚¿ãƒ³"):
            time.sleep(3)
            print("âœ“ æ³¨æ–‡ãŒå®Œäº†ã—ã¾ã—ãŸï¼")
            return True
        return False
    
    def complete_purchase_flow(self, product_search, customer_info, payment_method='card', 
                               quantity=1, confirm_order=False):
        """
        å®Œå…¨ãªè³¼å…¥ãƒ•ãƒ­ãƒ¼
        
        Args:
            product_search: æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰
            customer_info: é¡§å®¢æƒ…å ±ã®è¾æ›¸
            payment_method: æ”¯æ‰•ã„æ–¹æ³•
            quantity: æ•°é‡
            confirm_order: å®Ÿéš›ã«æ³¨æ–‡ã‚’ç¢ºå®šã™ã‚‹ã‹ï¼ˆãƒ†ã‚¹ãƒˆæ™‚ã¯Falseæ¨å¥¨ï¼‰
        """
        print("\n" + "="*60)
        print("ğŸ›’ è‡ªå‹•è³¼å…¥ãƒ•ãƒ­ãƒ¼é–‹å§‹")
        print("="*60)
        
        try:
            # 1. ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã¸
            self.navigate_to_home()
            
            # 2. å•†å“æ¤œç´¢
            if not self.search_product(product_search):
                raise Exception("å•†å“æ¤œç´¢ã«å¤±æ•—")
            
            # 3. å•†å“é¸æŠ
            if not self.select_product(position=1):
                raise Exception("å•†å“é¸æŠã«å¤±æ•—")
            
            # 4. ã‚«ãƒ¼ãƒˆã«è¿½åŠ 
            if not self.add_to_cart(quantity=quantity):
                raise Exception("ã‚«ãƒ¼ãƒˆè¿½åŠ ã«å¤±æ•—")
            
            # 5. ã‚«ãƒ¼ãƒˆãƒšãƒ¼ã‚¸ã¸
            if not self.go_to_cart():
                raise Exception("ã‚«ãƒ¼ãƒˆãƒšãƒ¼ã‚¸é·ç§»ã«å¤±æ•—")
            
            # 6. ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã¸
            if not self.proceed_to_checkout():
                raise Exception("ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆé·ç§»ã«å¤±æ•—")
            
            # 7. ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›
            if not self.fill_checkout_form(customer_info):
                raise Exception("ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ã«å¤±æ•—")
            
            # 8. æ”¯æ‰•ã„æ–¹æ³•é¸æŠ
            if not self.select_payment_method(payment_method):
                raise Exception("æ”¯æ‰•ã„æ–¹æ³•é¸æŠã«å¤±æ•—")
            
            # 9. æ³¨æ–‡ç¢ºå®š
            if not self.place_order(confirm=confirm_order):
                print("âš ï¸ æ³¨æ–‡ç¢ºå®šã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã—ãŸï¼ˆãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼‰")
            
            print("\n" + "="*60)
            print("âœ… è³¼å…¥ãƒ•ãƒ­ãƒ¼å®Œäº†")
            print("="*60)
            
            return True
            
        except Exception as e:
            print(f"\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
            return False
    
    def cleanup(self):
        """ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—"""
        print("\nãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¾ã™...")
        time.sleep(2)
        self.driver.quit()


# ===== å®Ÿè¡Œä¾‹ =====
if __name__ == "__main__":
    
    # ECã‚µã‚¤ãƒˆè‡ªå‹•åŒ–ã‚’åˆæœŸåŒ–
    bot = EcommerceAutomation(
        base_url="https://example-shop.com",
        coordinates_file="ecommerce_coords.json"
    )
    
    # é¡§å®¢æƒ…å ±
    customer_data = {
        'name': 'å±±ç”°å¤ªéƒ',
        'email': 'taro.yamada@example.com',
        'address': 'æ±äº¬éƒ½æ¸‹è°·åŒº1-2-3',
        'city': 'æ¸‹è°·åŒº',
        'zip': '150-0001',
        'phone': '090-1234-5678'
    }
    
    try:
        # å®Œå…¨ãªè³¼å…¥ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œ
        success = bot.complete_purchase_flow(
            product_search="ãƒ¯ã‚¤ãƒ¤ãƒ¬ã‚¹ã‚¤ãƒ¤ãƒ›ãƒ³",
            customer_info=customer_data,
            payment_method='card',
            quantity=2,
            confirm_order=False  # ãƒ†ã‚¹ãƒˆã®ãŸã‚æ³¨æ–‡ç¢ºå®šã¯ã—ãªã„
        )
        
        if success:
            print("\nâœ… ã™ã¹ã¦ã®æ“ä½œãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸ")
        else:
            print("\nâŒ ä¸€éƒ¨ã®æ“ä½œãŒå¤±æ•—ã—ã¾ã—ãŸ")
        
        # çµæœç¢ºèªã®ãŸã‚å°‘ã—å¾…æ©Ÿ
        input("\nEnterã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¾ã™...")
        
    finally:
        bot.cleanup()


ğŸ“š åº§æ¨™ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¾‹
ecommerce_coords.json
{
  "home": {
    "search_box": [800, 100],
    "cart_icon": [1800, 80],
    "menu_button": [50, 80],
    "logo": [150, 80],
    "user_menu": [1700, 80]
  },
  "product_list": {
    "first_product": [300, 400],
    "second_product": [700, 400],
    "third_product": [1100, 400],
    "fourth_product": [1500, 400],
    "filter_button": [100, 300],
    "sort_dropdown": [1700, 250],
    "view_grid": [1600, 250],
    "view_list": [1650, 250],
    "page_2": [1000, 950],
    "page_3": [1050, 950]
  },
  "product_detail": {
    "add_to_cart": [1400, 650],
    "buy_now": [1400, 700],
    "quantity_plus": [1250, 550],
    "quantity_minus": [1150, 550],
    "size_selector": [1200, 450],
    "color_selector": [1200, 500],
    "wishlist_button": [1600, 350],
    "share_button": [1650, 350],
    "reviews_tab": [600, 850],
    "description_tab": [400, 850],
    "specifications_tab": [800, 850]
  },
  "cart": {
    "checkout_button": [1500, 900],
    "continue_shopping": [400, 900],
    "remove_item": [1700, 400],
    "update_quantity": [1600, 450],
    "coupon_field": [800, 700],
    "apply_coupon": [1000, 700],
    "estimate_shipping": [800, 750]
  },
  "checkout": {
    "name_field": [600, 300],
    "email_field": [600, 350],
    "address_field": [600, 400],
    "address2_field": [600, 450],
    "city_field": [600, 500],
    "state_field": [600, 550],
    "zip_field": [600, 600],
    "phone_field": [600, 650],
    "payment_card": [500, 750],
    "payment_paypal": [700, 750],
    "payment_bank": [900, 750],
    "place_order": [800, 950],
    "back_to_cart": [400, 950]
  }
}


ğŸ¯ æœ€å¾Œã«ï¼šåº§æ¨™æŒ‡å®šã‚’ä½¿ã†ã¹ãå ´é¢
âœ… åº§æ¨™æŒ‡å®šãŒé©ã—ã¦ã„ã‚‹å ´åˆ
Canvas/SVGã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³


ã‚²ãƒ¼ãƒ ã€æç”»ãƒ„ãƒ¼ãƒ«ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚°ãƒ©ãƒ•
Shadow DOM


Webã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã®è¦ç´ 
å‹•çš„ID/ã‚¯ãƒ©ã‚¹


ãƒ©ãƒ³ãƒ€ãƒ ã«ç”Ÿæˆã•ã‚Œã‚‹ID/ã‚¯ãƒ©ã‚¹å
iframeå†…ã®è¤‡é›‘ãªæ§‹é€ 


ã‚»ãƒ¬ã‚¯ã‚¿ã§ã¯å–å¾—å›°é›£ãªè¦ç´ 
ç”»åƒãƒ™ãƒ¼ã‚¹ã®UI


ç”»åƒèªè­˜ã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨
âŒ åº§æ¨™æŒ‡å®šã‚’é¿ã‘ã‚‹ã¹ãå ´åˆ
é€šå¸¸ã®HTMLè¦ç´ 


ã‚»ãƒ¬ã‚¯ã‚¿ã§å–å¾—å¯èƒ½ãªå ´åˆ
ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³


ç”»é¢ã‚µã‚¤ã‚ºã§è¦ç´ ä½ç½®ãŒå¤‰ã‚ã‚‹
é »ç¹ã«æ›´æ–°ã•ã‚Œã‚‹UI


ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãŒå¤‰æ›´ã•ã‚Œã‚„ã™ã„
æœ¬ç•ªç’°å¢ƒ


ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§ãŒä½ã„

ğŸš€ ã¾ã¨ã‚
åº§æ¨™æŒ‡å®šã¯æœ€å¾Œã®æ‰‹æ®µã§ã™ãŒã€é©åˆ‡ã«ä½¿ãˆã°å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ï¼
é‡è¦ãƒã‚¤ãƒ³ãƒˆ
ã‚»ãƒ¬ã‚¯ã‚¿å„ªå…ˆ - å¯èƒ½ãªé™ã‚ŠID/XPath/CSSã‚»ãƒ¬ã‚¯ã‚¿ã‚’ä½¿ã†
åº§æ¨™è£œæ­£ - ç”»é¢ã‚µã‚¤ã‚ºã«å¿œã˜ã¦èª¿æ•´
ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° - ãƒªãƒˆãƒ©ã‚¤å‡¦ç†ã‚’å¿…ãšå®Ÿè£…
ãƒ‡ãƒãƒƒã‚° - ãƒãƒ¼ã‚«ãƒ¼è¡¨ç¤ºã§è¦–è¦šçš„ã«ç¢ºèª
ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ– - åº§æ¨™ã®æ„å‘³ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã§æ®‹ã™
ã“ã‚Œã§åº§æ¨™æŒ‡å®šã®å®Œå…¨ãƒã‚¹ã‚¿ãƒ¼ã§ã™ï¼ğŸ‰


